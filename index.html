<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Nå­—æˆ°æ³•ï¼šä¸‰ç›¤è½‰æŠ˜åˆ¤æ–·è¨ˆç®—æ©Ÿ (V16.1 æˆ°ç•¥ç‰ˆ)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700;900&display=swap');
        body { font-family: 'Noto Sans TC', sans-serif; -webkit-tap-highlight-color: transparent; }
        .fade-in { animation: fadeIn 0.4s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }
        
        /* å·è»¸ç¾åŒ– */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }
        
        .invalid-target { text-decoration: line-through; color: #9ca3af; }
        .input-error { border-color: #ef4444 !important; ring: 2px; ring-color: #ef4444; background-color: #fef2f2; }
        
        /* é–ƒçˆæé†’ç‰¹æ•ˆ */
        @keyframes highlightPulse {
            0% { background-color: #fff; }
            50% { background-color: #fef9c3; } /* yellow-100 */
            100% { background-color: #fff; }
        }
        .highlight-input { animation: highlightPulse 1s ease-in-out; }

        /* æ‘ºç–Šé¸å–®æ¨£å¼ */
        details > summary { list-style: none; cursor: pointer; transition: all 0.2s; }
        details > summary::-webkit-details-marker { display: none; }
        details[open] > summary { margin-bottom: 0.5rem; }
        details > summary:hover { background-color: #f8fafc; }

        /* AI Loading Animation */
        .dot-flashing {
            position: relative;
            width: 6px;
            height: 6px;
            border-radius: 5px;
            background-color: #6366f1;
            color: #6366f1;
            animation: dot-flashing 1s infinite linear alternate;
            animation-delay: 0.5s;
        }
        .dot-flashing::before, .dot-flashing::after {
            content: "";
            display: inline-block;
            position: absolute;
            top: 0;
        }
        .dot-flashing::before {
            left: -10px;
            width: 6px;
            height: 6px;
            border-radius: 5px;
            background-color: #6366f1;
            color: #6366f1;
            animation: dot-flashing 1s infinite alternate;
            animation-delay: 0s;
        }
        .dot-flashing::after {
            left: 10px;
            width: 6px;
            height: 6px;
            border-radius: 5px;
            background-color: #6366f1;
            color: #6366f1;
            animation: dot-flashing 1s infinite alternate;
            animation-delay: 1s;
        }
        @keyframes dot-flashing {
            0% { background-color: #6366f1; }
            50%, 100% { background-color: #e0e7ff; }
        }
        
        /* Markdown Styles for AI Response */
        .ai-content h1, .ai-content h2, .ai-content h3 { font-weight: 800; margin-top: 0.5em; margin-bottom: 0.3em; color: #1e1b4b; }
        .ai-content ul { list-style-type: disc; padding-left: 1.2em; margin-bottom: 0.5em; }
        .ai-content p { margin-bottom: 0.5em; line-height: 1.6; }
        .ai-content strong { color: #b91c1c; }
        .ai-content table { border-collapse: collapse; width: 100%; margin-bottom: 1em; font-size: 0.9em; }
        .ai-content th, .ai-content td { border: 1px solid #e2e8f0; padding: 0.5em; text-align: left; }
        .ai-content th { background-color: #f1f5f9; font-weight: bold; }
        
        /* V16.1 Banner Style */
        .v16-badge {
            background: linear-gradient(135deg, #FFD700 0%, #FFA500 100%);
            color: #8B4513;
            text-shadow: 0px 1px 0px rgba(255,255,255,0.4);
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
    </style>
</head>
<body class="bg-slate-100 min-h-screen flex items-center justify-center p-4">

    <div class="bg-white rounded-2xl shadow-2xl w-full max-w-xl overflow-hidden border border-slate-300 relative">
        <!-- Header -->
        <div class="bg-slate-900 p-5 text-white text-center relative z-20">
            <h1 class="text-2xl font-black tracking-wider">Nå­—æˆ°æ³•æŒ‡æ®ä¸­å¿ƒ by.çŸ³é ­ <span class="v16-badge px-2 py-0.5 rounded text-sm align-top ml-1 font-bold">V16.1</span></h1>
            <p class="text-xs text-slate-400 mt-1">é‡èƒ½åŠ‡æœ¬ x ç›¤æ…‹åˆ¤è®€ x å¯¦æˆ°ä¸‰å•</p>
        </div>

        <!-- æˆ°æ³•ç™¾ç§‘å…¨æ›¸ (Accordion Menu) -->
        <div class="bg-slate-50 border-b border-slate-200">
            <div class="p-3 text-center bg-blue-700 text-white font-bold text-sm cursor-pointer hover:bg-blue-800 transition-colors" onclick="toggleEncyclopedia()">
                ğŸ“– é»æˆ‘æ‰“é–‹ï¼šNå­—æˆ°æ³•å…¨èƒ½ç™¾ç§‘ (åœ–è§£ç²¾è¯) â–¼
            </div>
            
            <div id="encyclopediaContent" class="hidden max-h-[500px] overflow-y-auto p-4 space-y-3 shadow-inner bg-white">
                <!-- Part 1: åŸºç¤è¶¨å‹¢ -->
                <div class="text-xs font-black text-slate-400 uppercase tracking-widest mt-2 mb-1">ç¬¬ä¸€ç¯‡ï¼šåŸºç¤è¶¨å‹¢èˆ‡è½‰æŠ˜ (å®šå¤šç©º)</div>
                <details class="group border border-indigo-200 rounded overflow-hidden">
                    <summary class="flex justify-between items-center font-bold text-indigo-800 bg-indigo-50 p-3">
                        <span>1. è¶¨å‹¢ç¯‡ï¼šæœ«å‡ä½ & æœ«è·Œé«˜</span>
                        <span class="text-indigo-500 transition-transform group-open:rotate-180">â–¼</span>
                    </summary>
                    <div class="p-3 text-xs text-slate-700 bg-white space-y-2">
                        <p><span class="font-bold text-red-600">â— æœ«å‡ä½ (Last Rising Low)ï¼š</span>å¤šé ­å‰µé«˜æ³¢æ®µçš„ã€Œèµ·æ¼²é»ã€ã€‚<br>é‚è¼¯ï¼šå®ˆä½æœ«å‡ä½=å¤šé ­ï¼Œè·Œç ´=è¶¨å‹¢ç ´å£ã€‚</p>
                        <p><span class="font-bold text-green-600">â— æœ«è·Œé«˜ (Last Falling High)ï¼š</span>ç©ºé ­å‰µä½æ³¢æ®µçš„ã€Œèµ·è·Œé»ã€ã€‚<br>é‚è¼¯ï¼šçªç ´æœ«è·Œé«˜=ç©ºç¿»å¤šã€‚</p>
                    </div>
                </details>

                <details class="group border border-indigo-200 rounded overflow-hidden">
                    <summary class="flex justify-between items-center font-bold text-indigo-800 bg-indigo-50 p-3">
                        <span>2. è½‰æŠ˜è¨Šè™Ÿï¼šæ—¥å‡ºç·š & æ—¥è½ç·š</span>
                        <span class="text-indigo-500 transition-transform group-open:rotate-180">â–¼</span>
                    </summary>
                    <div class="p-3 text-xs text-slate-700 bg-white space-y-2">
                        <p><span class="font-bold text-red-600">ğŸŒ… æ—¥å‡ºç·š (Sunrise)ï¼š</span>é«˜éæ˜¨é«˜ï¼Œæ”¶ç›¤æ”¶é«˜ã€‚<br>ç”¨é€”ï¼šå›æª”æ™‚çš„æ­¢è·Œè²·è¨Šã€‚</p>
                        <p><span class="font-bold text-green-600">ğŸŒ‡ æ—¥è½ç·š (Sunset)ï¼š</span>ä½ç ´æ˜¨ä½ï¼Œæ”¶ç›¤æ”¶ä½ã€‚<br>ç”¨é€”ï¼šä¸Šæ¼²æ™‚çš„æ­¢æ¼²è³£è¨Šã€‚</p>
                        <p class="bg-indigo-50 p-1 rounded font-bold text-center">å£è¨£ï¼šå›æª”æ‰¾æ—¥å‡ºï¼Œä¸Šæ¼²é˜²æ—¥è½ã€‚</p>
                    </div>
                </details>

                <details class="group border border-purple-200 rounded overflow-hidden">
                    <summary class="flex justify-between items-center font-bold text-purple-800 bg-purple-50 p-3">
                        <span>3. é˜²å®ˆç¯‡ï¼šè»‹ç©ºä½ & ç¿»ç´…å®šç¾©</span>
                        <span class="text-purple-500 transition-transform group-open:rotate-180">â–¼</span>
                    </summary>
                    <div class="p-3 text-xs text-slate-700 bg-white space-y-3">
                        <p><span class="font-bold bg-indigo-100 text-indigo-800 px-1 rounded">ç¿»ç´…Kæ£’ï¼š</span> å¯¶å¡”ç·šç”±ç¶ ç¿»ç´… (æ”¶ç›¤ > å‰ä¸‰é«˜) ç•¶å¤©çš„é‚£æ ¹Kæ£’ã€‚</p>
                        <p><span class="font-bold bg-purple-100 text-purple-800 px-1 rounded">è»‹ç©ºä½ï¼š</span> ç¿»ç´…Kæ£’çš„<span class="text-red-600 font-bold">æœ€ä½é»</span>ã€‚</p>
                        
                        <!-- æˆæœ¬è¿·æ€è§£æƒ‘ -->
                        <div class="bg-red-50 p-2 rounded border border-red-200">
                            <p class="font-bold text-red-800 border-b border-red-200 pb-1 mb-1">ğŸ’¡ è»‹ç©ºä½å¡«å“ªä¸€å¤©ï¼Ÿ</p>
                            <p class="mb-1 text-slate-800 font-bold">Nå­—æˆ°æ³•æ“ä½œã€Œç•¶ä¸‹ã€ï¼Œä¸å•æˆæœ¬ï¼</p>
                            <div class="grid grid-cols-1 gap-2 mt-2">
                                <div class="bg-yellow-50 p-2 rounded border border-yellow-200">
                                    <p class="font-bold text-yellow-800">ğŸ“Œ æƒ…å¢ƒ A (ç©ºæ‰‹æƒ³è²·)</p>
                                    <p>è¼¸å…¥ï¼šå¡« <span class="font-bold text-red-600">ã€Œä»Šå¤©ã€</span> çš„ç›¤ä¸­æœ€ä½é»ã€‚</p>
                                </div>
                                <div class="bg-green-50 p-2 rounded border border-green-200">
                                    <p class="font-bold text-green-800">ğŸ“Œ æƒ…å¢ƒ B (æŒæœ‰çºŒæŠ±)</p>
                                    <p>è¼¸å…¥ï¼šå¡« <span class="font-bold text-red-600">ã€Œç•¶åˆè²·é€²é‚£å¤©ã€</span> çš„æœ€ä½é»ã€‚</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </details>

                 <!-- NEW: å¯¶å¡”ç·šé‚è¼¯ -->
                <div class="text-xs font-black text-slate-400 uppercase tracking-widest mt-4 mb-1">ç¬¬äºŒç¯‡ï¼šå¯¶å¡”ç·šèˆ‡ç›¤æ…‹åœ–è§£ (é‡é»)</div>

                <details class="group border border-blue-200 rounded overflow-hidden">
                    <summary class="flex justify-between items-center font-bold text-blue-800 bg-blue-50 p-3">
                        <span>4. åŸç†ç¯‡ï¼šå¯¶å¡”ç·š (TOW) é‚è¼¯è©³è§£</span>
                        <span class="text-blue-500 transition-transform group-open:rotate-180">â–¼</span>
                    </summary>
                    <div class="p-3 text-xs text-slate-700 bg-white space-y-3">
                         <div class="bg-yellow-50 p-2 rounded border border-yellow-200">
                            <p class="font-bold text-yellow-900 border-b border-yellow-200 pb-1 mb-1">ğŸ’¡ ç‚ºä»€éº¼è§€å¯Ÿä¸‰å¤©ï¼Ÿ (åƒæ•¸=3)</p>
                            <ul class="list-decimal list-inside space-y-1 text-yellow-800">
                                <li><span class="font-bold">éæ¿¾å‡è¨Šè™Ÿï¼š</span>é¿å…ã€Œä¸€æ—¥è¡Œæƒ…ã€ã€‚</li>
                                <li><span class="font-bold">å¿ƒç†é˜²ç·šï¼š</span>Day 1 è®Šç›¤ï¼ŒDay 2 å»¶çºŒï¼ŒDay 3 ç¢ºç«‹ã€‚</li>
                                <li><span class="font-bold">æ“ä½œç²¾é«“ï¼š</span>ç¶ ç¿»ç´…å¾Œï¼Œè‹¥é€£çºŒä¸‰å¤©ä¸ç ´ Day 1 ä½é»ï¼Œå¤šé ­ç¢ºç«‹ã€‚</li>
                            </ul>
                        </div>
                    </div>
                </details>

                <!-- Part 2: ç›¤æ…‹èˆ‡æ”»æ“Š (ä¾æ“šåœ–ç‰‡æ›´æ–° - NEW) -->
                
                <details class="group border border-orange-200 rounded overflow-hidden" open>
                    <summary class="flex justify-between items-center font-bold text-orange-800 bg-orange-50 p-3">
                        <span>5. å¿ƒæ³•ç¯‡ï¼šç›¤æ…‹åˆ†é¡ (åœ–è§£å°ç…§)</span>
                        <span class="text-orange-500 transition-transform group-open:rotate-180">â–¼</span>
                    </summary>
                    <div class="p-3 text-xs text-slate-700 bg-white space-y-4">
                        
                        <!-- åœ–è§£: å¤šæ–¹ä¸‰ç›¤æ…‹ (User Uploaded) -->
                        <div>
                            <p class="font-bold bg-red-100 text-red-800 px-1 rounded inline-block mb-1">ğŸ“ˆ å¤šæ–¹è¶¨å‹¢ (Bullish)</p>
                            <div class="flex flex-col items-center my-2 p-2 border border-slate-200 rounded bg-white">
                                <div class="w-full text-center text-[10px] text-gray-500 mb-1">â–¼ åœ–ä¸€ï¼šå¤šæ–¹ç›¤æ…‹èˆ‡ç©ºé ­æŠµæŠ— (æŒ‰åœ–æ“ä½œ) â–¼</div>
                                <div class="w-full h-auto rounded shadow-sm bg-gray-100 p-2 text-center text-xs text-gray-500 flex justify-around">
                                    <!-- æ¨¡æ“¬åœ–ç¤ºçµæ§‹ (å¯¦éš›ç‚ºæ–‡å­—æè¿°åœ–ä¸­ç²¾é«“) -->
                                    <div class="w-1/3 border-r border-gray-300 px-1">
                                        <div class="font-bold text-orange-600 mb-1">â‘  ç›¤å …ç›¤</div>
                                        <div class="text-[9px]">ç©ºé ­æŠµæŠ—å¼·<br>å›æª”æ·±<br>å®ˆè»‹ç©ºä½</div>
                                    </div>
                                    <div class="w-1/3 border-r border-gray-300 px-1">
                                        <div class="font-bold text-blue-600 mb-1">â‘¡ è»‹ç©ºç›¤</div>
                                        <div class="text-[9px]">ç©ºé ­æŠµæŠ—å¼±<br>é«˜æª”æ——å‹<br>ä»¥ç›¤ä»£è·Œ</div>
                                    </div>
                                    <div class="w-1/3 px-1">
                                        <div class="font-bold text-red-600 mb-1">â‘¢ å¼·è»‹ç©º</div>
                                        <div class="text-[9px]">æŠµæŠ—å¤±æ•—<br>ä¸å›é ­<br>ç›´æ¥å™´å‡º</div>
                                    </div>
                                </div>
                                <div class="mt-2 text-left w-full space-y-1">
                                     <p>â‘  <span class="font-bold text-orange-600">ç›¤å …ç›¤ (Accumulation)ï¼š</span> å›æª”è¼ƒæ·±ï¼Œé»‘Kåå™¬ç´…æ£’ï¼Œä½†<span class="bg-orange-100 px-1 rounded font-bold">å®ˆä½è»‹ç©ºä½</span>ã€‚ç­–ç•¥ï¼šè€å¿ƒç­‰å¾…ã€‚</p>
                                     <p>â‘¡ <span class="font-bold text-blue-600">è»‹ç©ºç›¤ (Squeeze)ï¼š</span> é«˜æª”æ•´ç†ï¼Œ<span class="bg-blue-100 px-1 rounded font-bold">ç©ºé ­æŠµæŠ—</span>å‡ºç¾ä½†å®ˆä½æ˜¨æ—¥é«˜é»ã€‚ç­–ç•¥ï¼šçºŒæŠ±çœ‹ä¸€é£½ã€‚</p>
                                     <p>â‘¢ <span class="font-bold text-red-600">å¼·è»‹ç©º (Super Squeeze)ï¼š</span> <span class="bg-red-100 px-1 rounded font-bold">ç©ºé ­æŠµæŠ—å¤±æ•—</span>(ç´…æ¡†è™•)ï¼Œéš”æ—¥é–‹é«˜èµ°é«˜ã€‚ç­–ç•¥ï¼šæ­»æŠ±çœ‹äº”å€ã€‚</p>
                                </div>
                            </div>
                        </div>

                        <!-- ç©ºæ–¹ç›¤æ…‹èªªæ˜ (Updated) -->
                        <div class="border-t border-slate-200 pt-2">
                            <p class="font-bold bg-green-100 text-green-800 px-1 rounded inline-block mb-1">ğŸ“‰ ç©ºæ–¹è¶¨å‹¢ (Bearish)</p>
                            <ul class="space-y-2 ml-1">
                                <li>
                                    <span class="font-bold text-green-700">â‘  å¼·æ®ºå¤šï¼š</span>è·³ç©ºå‘ä¸‹ï¼Œé€£é»‘Kï¼Œå®Œå…¨ç„¡åå½ˆã€‚<br>
                                    <span class="text-slate-500">â†’ ç­–ç•¥ï¼šçµ•å°ä¸æ¥åˆ€ï¼Œåå½ˆå°±æ˜¯ç©ºã€‚</span>
                                </li>
                                <li>
                                    <span class="font-bold text-green-600">â‘¡ æ®ºå¤šç›¤ï¼š</span>å¼±å‹¢æ•´ç†å†ç ´åº•ã€‚<br>
                                    <span class="text-slate-500">â†’ ç­–ç•¥ï¼šåˆ©ç”¨åå½ˆé€ƒå‘½ï¼Œç©ºæ–¹çºŒæŠ±ã€‚</span>
                                </li>
                                <li><span class="font-bold text-slate-600">â‘¢ ç›¤è·Œç›¤ï¼š</span>è·Œç ´å¾Œåå½ˆæ·±(å‡çªç ´å›é ¸ç·š)ï¼Œéš¨å¾Œå†æ®ºã€‚<br>
                                    <span class="text-slate-500">â†’ ç­–ç•¥ï¼šå€é–“æ“ä½œï¼Œåš´è¨­åœæã€‚</span>
                                </li>
                            </ul>
                        </div>
                    </div>
                </details>
                
                <div class="text-xs font-black text-slate-400 uppercase tracking-widest mt-4 mb-1">ç¬¬ä¸‰ç¯‡ï¼šå¯¦æˆ°èˆ‡é›¢å ´ (SOP)</div>

                <details class="group border border-green-200 rounded overflow-hidden">
                    <summary class="flex justify-between items-center font-bold text-green-800 bg-green-50 p-3">
                        <span>6. æ”»æ“Šç¯‡ï¼šNå­—æ¸¬å¹… (æ‰‹ç¨¿å…¬å¼)</span>
                        <span class="text-green-500 transition-transform group-open:rotate-180">â–¼</span>
                    </summary>
                    <div class="p-3 text-xs text-slate-700 bg-white space-y-2">
                        <p>åƒæ•¸ï¼š<span class="font-bold text-red-600">h2 (ä»Šæ—¥æœ€é«˜)</span>ï¼Œ<span class="font-bold text-green-600">L (å‰ä¸‰ä½)</span></p>
                        <div class="bg-green-50 p-2 rounded border border-green-100 font-mono">
                            <p>â— <span class="font-bold">ä¸€é£½ (1N)ï¼š</span> h2 Ã— 2 - L (åŸºæœ¬æ»¿è¶³)</p>
                            <p>â— <span class="font-bold">äºŒå (2N)ï¼š</span> ä¸€é£½ + (h2 - L) (å¼·å‹¢é£†è‚¡)</p>
                            <p>â— <span class="font-bold">äº”å€ (5x)ï¼š</span> h2 + 5 Ã— (h2 - L) (æ‘ºç–Šç¿»ç®±)</p>
                        </div>
                    </div>
                </details>

                <details class="group border border-indigo-200 rounded overflow-hidden">
                    <summary class="flex justify-between items-center font-bold text-indigo-800 bg-indigo-50 p-3">
                        <span>7. é€²éšç¯‡ï¼šé•·ç´…éš”æ—¥å¼·å¼±åˆ¤å®š</span>
                        <span class="text-indigo-500 transition-transform group-open:rotate-180">â–¼</span>
                    </summary>
                    <div class="p-3 text-xs text-slate-700 bg-white space-y-2">
                        <p class="font-bold">çªç ´å¸¶é‡é•·ç´…æ£’ï¼Œéš”æ—¥èµ°å‹¢è‡³é—œé‡è¦ï¼š</p>
                        <ol class="list-decimal list-inside space-y-1 ml-1">
                            <li><span class="font-bold text-red-600">ç¹¼çºŒæ¼²ï¼š</span> å¼·å‹¢ (Strong)ã€‚</li>
                            <li><span class="font-bold text-red-500">ä¸ç ´ 1/3ï¼š</span> æ¬¡å¼· (Normal)ã€‚</li>
                            <li><span class="font-bold text-orange-500">ä¸ç ´ 1/2ï¼š</span> æ¬¡æ¬¡å¼· (Weak but Hold)ã€‚</li>
                            <li><span class="font-bold text-gray-500">è·Œç ´ 1/2 æˆ–ä½é»ï¼š</span> å‡çªç ´ (False Breakout)ã€‚</li>
                        </ol>
                    </div>
                </details>
                
                <details class="group border border-red-200 rounded overflow-hidden">
                    <summary class="flex justify-between items-center font-bold text-red-800 bg-red-50 p-3">
                        <span>8. é›¢å ´ç¯‡ï¼šä¸–ç´€é‹¼ (9958) è³£è¨Š</span>
                        <span class="text-red-500 transition-transform group-open:rotate-180">â–¼</span>
                    </summary>
                    <div class="p-3 text-xs text-slate-700 bg-white space-y-2">
                        <p class="font-bold text-red-700">è³£å‡ºä¸‰éƒ¨æ›² (ä¸–ç´€é‹¼æ•™è¨“)ï¼š</p>
                        <ol class="list-decimal list-inside ml-1">
                            <li><span class="font-bold">è¶¨å‹¢è½‰å¼±ï¼š</span>å‡ç·š (EMA 8/21/55) ä¸Šæ¼²è®Šç·©æˆ–èµ°å¹³ã€‚</li>
                            <li><span class="font-bold">çµæ§‹è·Œç ´ï¼š</span>ä¸‰ç›¤è·Œç ´ + è·Œç ´æ‰€æœ‰å‡ç·šã€‚</li>
                            <li><span class="font-bold">æŒ‡æ¨™ç¢ºèªï¼š</span>è½å°¾æ—¥è½ + å¯¶å¡”ç¿»ç¶ ã€‚</li>
                        </ol>
                        <p class="bg-red-50 p-1 text-center font-bold text-red-900 mt-1">çµè«–ï¼šå¤šé ­å·²æ­»ï¼Œæœæ–·æ›è‚¡ï¼</p>
                    </div>
                </details>
                
                <!-- è¼¸å…¥æŒ‡å— -->
                 <details class="group border border-gray-200 rounded overflow-hidden">
                    <summary class="flex justify-between items-center font-bold text-gray-800 bg-gray-50 p-3">
                        <span>9. SOPï¼šç›¤ä¸­è¼¸å…¥æŒ‡å—</span>
                        <span class="text-gray-500 transition-transform group-open:rotate-180">â–¼</span>
                    </summary>
                    <div class="p-3 text-xs text-slate-700 bg-white">
                        æ”¶ç›¤åƒ¹(è·³å‹•åƒ¹)ã€ä»Šæ—¥æœ€é«˜(ç®—ç›®æ¨™)ã€è»‹ç©ºä½(ç¿»ç´…æ—¥ä½)ã€å‰ä¸‰é«˜/ä½(æ˜¨å‰å¤§å‰)
                    </div>
                </details>

                <!-- NEW: é åˆ¤æ•™å­¸ -->
                <details class="group border border-sky-200 rounded overflow-hidden" open>
                    <summary class="flex justify-between items-center font-bold text-sky-800 bg-sky-50 p-3">
                        <span>10. é åˆ¤ç¯‡ï¼šå¦‚ä½•æ¨¡æ“¬æœªä¾†èµ°å‹¢ï¼Ÿ</span>
                        <span class="text-sky-500 transition-transform group-open:rotate-180">â–¼</span>
                    </summary>
                    <div class="p-3 text-xs text-slate-700 bg-white space-y-2">
                        <p class="font-bold text-red-600 border-b border-sky-100 pb-1">Q: æ€éº¼é æ¸¬æ˜å¤©ï¼Ÿ(æ¨¡æ“¬æˆ°æƒ…å®¤ç”¨æ³•)</p>
                        <ol class="list-decimal list-inside ml-1 space-y-2">
                            <li><span class="font-bold bg-blue-100 text-blue-800 px-1 rounded">æƒ…å¢ƒæŒ‰éˆ• (æ–°æ‰‹)ï¼š</span>
                                <div class="pl-4 text-slate-500 mt-1">
                                    ä¸Šæ–¹è—è‰²å€å¡Šçš„æŒ‰éˆ• (å¦‚ï¼šæ¨¡æ“¬æ¥µå¼·)ï¼Œæ˜¯<span class="bg-yellow-100 text-slate-800 px-1">ç³»çµ±è‡ªå‹•å¡«å…¥å‡æ•¸æ“š</span>ï¼ŒæŒ‰ä¸‹å»å¾Œè«‹ç›´æ¥çœ‹æœ€ä¸‹æ–¹çš„ã€Œåˆ†æçµæœã€ï¼Œè®“ä½ ç·´ç¿’ã€Œçœ‹åˆ°é€™ç¨®æ•¸æ“šè©²æ€éº¼åšã€ã€‚
                                </div>
                            </li>
                            <li><span class="font-bold bg-slate-800 text-white px-1 rounded">æ‰‹å‹•é æ¼” (è€æ‰‹)ï¼š</span>
                                <ul class="list-none list-inside pl-4 text-slate-600 mt-1 space-y-1">
                                    <li>â‘  å¡«å…¥çœŸå¯¦çš„ <span class="font-bold">å‰ä¸‰é«˜ã€å‰ä¸‰ä½ã€å‡é‡</span> (é€™æ˜¯å·²çŸ¥æ­·å²)ã€‚</li>
                                    <li>â‘¡ æ›´æ”¹ <span class="text-blue-700 font-bold">ç›®å‰åƒ¹</span> (è¼¸å…¥ï¼šä½ å‡è¨­æ˜å¤©æœƒæ¼²åˆ°çš„åƒ¹æ ¼)ã€‚</li>
                                    <li>â‘¢ æ›´æ”¹ <span class="text-purple-700 font-bold">æˆäº¤é‡</span> (è¼¸å…¥ï¼šä½ é ä¼°æ˜å¤©çš„é‡)ã€‚</li>
                                    <li>â‘£ æŒ‰ä¸‹é»‘è‰² <span class="font-bold bg-black text-white px-1 text-[10px] rounded">åŸ·è¡Œå¯¦æˆ°æ¨æ¼”</span> æŒ‰éˆ•ã€‚</li>
                                </ul>
                                <p class="text-center text-red-600 font-bold mt-1 bg-red-50 p-1">ğŸ’¡ çµè«–ï¼šåˆ©ç”¨å‡æƒ³çš„æ˜å¾Œå¤©åƒ¹æ ¼ï¼Œå…ˆç®—å‡ºä¸‹ä¸€æ­¥ç­–ç•¥ï¼</p>
                            </li>
                        </ol>
                    </div>
                </details>
            </div>
        </div>

        <div class="p-6 space-y-5 relative z-0">
            
            <!-- æ¨¡æ“¬æˆ°æƒ…å®¤ (New) -->
            <div class="bg-blue-50 p-3 rounded-lg border border-blue-200">
                <h3 class="text-xs font-black text-blue-900 mb-2 flex items-center">
                    ğŸ® æ¨¡æ“¬æˆ°æƒ…å®¤ (å¿«é€Ÿæ¼”ç¿’)
                </h3>
                <div class="grid grid-cols-2 gap-2">
                    <button onclick="simulate('strong')" class="bg-red-500 hover:bg-red-600 text-white font-bold py-2 rounded text-xs transition-colors flex items-center justify-center shadow-sm">
                        ğŸš€ æ¨¡æ“¬æ¥µå¼·
                    </button>
                    <button onclick="simulate('break')" class="bg-orange-500 hover:bg-orange-600 text-white font-bold py-2 rounded text-xs transition-colors flex items-center justify-center shadow-sm">
                        ğŸ”¥ æ¨¡æ“¬çªç ´
                    </button>
                    <button onclick="simulate('crash')" class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 rounded text-xs transition-colors flex items-center justify-center shadow-sm">
                        ğŸ’€ æ¨¡æ“¬å¤§è·Œ
                    </button>
                    <button onclick="simulate('flat')" class="bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 rounded text-xs transition-colors flex items-center justify-center shadow-sm">
                        â– æ¨¡æ“¬ç›¤æ•´
                    </button>
                </div>
            </div>
            
            <!-- 0. è‚¡ç¥¨ä»£ç¢¼ -->
            <div>
                <label class="block text-slate-700 font-bold mb-1 text-sm">è‚¡ç¥¨åç¨±/ä»£è™Ÿ</label>
                <input type="text" id="stockName" class="w-full p-2 border-2 border-slate-200 rounded focus:ring-2 focus:ring-slate-500 font-bold placeholder-slate-300 transition-colors" placeholder="ä¾‹å¦‚ï¼šä¸–ç´€é‹¼ (9958)">
            </div>

            <!-- 1. ç‹€æ…‹é¸æ“‡ -->
            <div>
                <label class="block text-slate-700 font-bold mb-2 text-sm">1. ç›®å‰å¯¶å¡”ç·šé¡è‰² (ç‹€æ…‹)</label>
                <div class="grid grid-cols-2 gap-3">
                    <button onclick="setStatus('GREEN')" id="btn-green" class="py-3 px-4 border-2 rounded-lg font-bold transition-all border-green-500 bg-green-50 text-green-700 shadow-inner ring-2 ring-green-100 opacity-100">
                        ğŸŸ© ç¶ è‰² (ç©ºæ‰‹/ç›¤æ•´)
                    </button>
                    <button onclick="setStatus('RED')" id="btn-red" class="py-3 px-4 border-2 rounded-lg font-bold transition-all border-slate-200 text-slate-400 hover:bg-slate-50 opacity-60">
                        ğŸŸ¥ ç´…è‰² (æŒæœ‰/å¤šæ–¹)
                    </button>
                </div>
                <input type="hidden" id="currentStatus" value="GREEN">
            </div>

            <!-- 2. æ ¸å¿ƒåƒ¹æ ¼ -->
            <div class="border-t border-slate-200 pt-4">
                <h3 class="text-sm font-black text-slate-800 mb-3 border-l-4 border-blue-600 pl-2">æ ¸å¿ƒåƒ¹æ ¼ (Price Action)</h3>
                <div class="grid grid-cols-2 gap-4 mb-3">
                    <div class="col-span-2 grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-blue-900 font-bold mb-1 text-xs">ç›®å‰åƒ¹ (Current)</label>
                            <input type="number" step="0.01" id="closePrice" class="w-full p-2 border-2 border-blue-200 rounded focus:ring-blue-500 text-lg font-mono font-bold text-blue-900" placeholder="è·³å‹•åƒ¹">
                        </div>
                        <div>
                            <label class="block text-red-700 font-bold mb-1 text-xs">ä»Šæ—¥æœ€é«˜ <span class="bg-red-100 px-1 rounded">h2</span></label>
                            <input type="number" step="0.01" id="todayHigh" class="w-full p-2 border-2 border-red-200 rounded focus:ring-red-500 text-lg font-mono font-bold text-red-700" placeholder="å‹•æ…‹æ¸¬å¹…ç”¨">
                        </div>
                    </div>
                    
                    <div>
                        <label class="block text-slate-500 font-bold mb-1 text-xs">å‰ä¸‰é«˜ (é ¸ç·š)</label>
                        <input type="number" step="0.01" id="high3d" class="w-full p-2 border border-slate-300 rounded font-mono text-sm" placeholder="æ˜¨/å‰/å¤§å‰">
                    </div>
                    <div>
                        <label class="block text-slate-500 font-bold mb-1 text-xs">å‰ä¸‰ä½ (L)</label>
                        <input type="number" step="0.01" id="low3d" class="w-full p-2 border border-slate-300 rounded font-mono text-sm" placeholder="æ˜¨/å‰/å¤§å‰">
                    </div>
                    
                    <!-- è»‹ç©ºä½æ¬„ä½ -->
                    <div class="col-span-2 bg-red-50 p-3 rounded-lg border-2 border-red-300 mt-2 relative overflow-hidden shadow-sm ring-2 ring-red-100">
                         <div class="absolute right-0 top-0 text-[60px] opacity-10 pointer-events-none transform rotate-12">ğŸ›¡ï¸</div>
                         <div class="flex justify-between items-center mb-1">
                             <label class="block text-purple-900 font-black mb-1 text-sm">â˜… è»‹ç©ºä½ (ç¿»ç´…Kæ£’æœ€ä½é»)</label>
                             <button onclick="toggleEncyclopedia()" class="text-[10px] bg-red-600 text-white px-2 py-0.5 rounded hover:bg-red-700 cursor-pointer shadow">â“ å¡«å“ªä¸€å¤©ï¼Ÿ</button>
                         </div>
                        <input type="number" step="0.01" id="breakoutLow" class="w-full p-2 border-2 border-purple-300 rounded font-mono text-lg text-purple-900 font-bold bg-white focus:ring-2 focus:ring-purple-500" placeholder="ç›®æ¨™åƒ¹ç”Ÿå­˜ç·š">
                        
                        <div class="mt-2 space-y-1 text-[11px] font-bold text-slate-600 bg-white/60 p-2 rounded border border-red-100">
                            <p>ğŸ‘‰ <span class="text-red-700">è‹¥ä»Šæ—¥å‰›çªç ´ï¼š</span>å¡«ã€Œä»Šå¤©ç›¤ä¸­ã€æœ€ä½é»ã€‚</p>
                            <p>ğŸ‘‰ <span class="text-green-700">è‹¥å·²æŒæœ‰çºŒæŠ±ï¼š</span>å¡«ã€Œç•¶åˆè²·é€²é‚£å¤©ã€æœ€ä½é»ã€‚</p>
                            <p class="text-red-500 mt-1 border-t border-red-100 pt-1 flex items-center"><span class="text-lg mr-1">âš¡</span> è·Œç ´æ­¤åƒ¹ = æ”»æ“Šå¤±æ•— (ç›®æ¨™æŠµéŠ·)</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 3. æˆäº¤é‡ -->
            <div class="border-t border-slate-200 pt-4">
                <h3 class="text-sm font-black text-slate-800 mb-3 border-l-4 border-purple-600 pl-2">æˆäº¤é‡çµæ§‹ (Volume)</h3>
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-purple-900 font-bold mb-1 text-xs">ä»Šæ—¥æˆäº¤é‡ (Today Vol)</label>
                        <input type="number" id="todayVol" class="w-full p-2 border-2 border-purple-200 rounded focus:ring-purple-500 font-mono text-lg font-bold text-purple-900" placeholder="é ä¼°é‡">
                    </div>
                    <div>
                        <label class="block text-slate-500 font-bold mb-1 text-xs">éå»ä¸‰æ—¥å‡é‡ (Avg Vol)</label>
                        <input type="number" id="avgVol" class="w-full p-2 border border-slate-300 rounded font-mono text-sm" placeholder="è¼¸å…¥5Tæ•¸å€¼">
                    </div>
                </div>
            </div>

            <!-- 4. å¼·å‹¢è‚¡åˆ¤å®šåƒæ•¸ (å«é•·ç´…å¼·å¼±åˆ¤å®š) -->
            <div id="advancedInputs" class="hidden bg-indigo-50 p-3 rounded-lg mt-4 border border-indigo-100">
                <h3 class="text-sm font-black text-indigo-900 mb-2">â˜… ç›¤æ…‹å¼·å¼±åˆ¤å®šåƒæ•¸ (é¸å¡«)</h3>
                <div class="grid grid-cols-3 gap-3">
                    <div>
                        <label class="block text-[10px] text-gray-500 font-bold mb-1">æ˜¨æ—¥æ”¶ç›¤</label>
                        <input type="number" id="prevClose" class="w-full p-1.5 border border-indigo-200 rounded text-sm text-center" placeholder="æ˜¨æ”¶">
                    </div>
                    <div>
                        <label class="block text-[10px] text-gray-500 font-bold mb-1">ä»Šæ—¥æœ€ä½</label>
                        <input type="number" id="todayLow" class="w-full p-1.5 border border-indigo-200 rounded text-sm text-center" placeholder="ä»Šä½">
                    </div>
                    <div>
                        <label class="block text-[10px] text-gray-500 font-bold mb-1">æ˜¨æ—¥æœ€ä½</label>
                        <input type="number" id="prevLow" class="w-full p-1.5 border border-indigo-200 rounded text-sm text-center" placeholder="æ˜¨ä½">
                    </div>
                    <div class="col-span-3 mt-1 pt-2 border-t border-indigo-200">
                        <label class="block text-[10px] text-gray-500 font-bold mb-1">æ˜¨æ—¥é•·ç´…ä½é» (ç”¨æ–¼éš”æ—¥å¼·å¼±åˆ¤å®š)</label>
                        <input type="number" id="prevLongRedLow" class="w-full p-1.5 border border-indigo-200 rounded text-sm text-center" placeholder="è‹¥æ˜¨æ—¥æ”¶é»‘å‰‡å…å¡«">
                    </div>
                </div>
            </div>

            <!-- è³£å‡ºæª¢æ ¸ -->
            <div id="sellChecklist" class="hidden bg-red-50 p-3 rounded border-2 border-red-200 mt-3">
                <h4 class="font-bold text-red-800 text-xs mb-2 flex items-center">ğŸ“‰ æ›è‚¡æ“ä½œæª¢æ ¸</h4>
                <div class="space-y-2">
                    <label class="flex items-center space-x-2 cursor-pointer bg-white p-2 rounded border border-red-100">
                        <input type="checkbox" id="checkTrend" class="form-checkbox h-4 w-4 text-red-600 rounded">
                        <span class="text-xs text-slate-800 font-bold">å‡ç·šä¸Šæ¼²è¶¨å‹¢ç·©</span>
                    </label>
                    <label class="flex items-center space-x-2 cursor-pointer bg-white p-2 rounded border border-red-100">
                        <input type="checkbox" id="checkMA" class="form-checkbox h-4 w-4 text-red-600 rounded">
                        <span class="text-xs text-slate-800 font-bold">ä¸‰ç›¤è·Œç ´æ‰€æœ‰å‡ç·š</span>
                    </label>
                    <label class="flex items-center space-x-2 cursor-pointer bg-white p-2 rounded border border-red-100">
                        <input type="checkbox" id="checkSunset" class="form-checkbox h-4 w-4 text-red-600 rounded">
                        <span class="text-xs text-slate-800 font-bold">è½å°¾æ—¥è½ & å¯¶å¡”ç¿»ç¶ </span>
                    </label>
                </div>
                <div id="sellAdvice" class="hidden mt-2 p-3 bg-red-600 text-white text-sm font-black rounded text-center animate-pulse shadow-lg transform scale-105">
                    ğŸš¨ æ¢ä»¶æˆç«‹ï¼šæ”¶å›è³‡é‡‘ï¼Œæ›è‚¡æ“ä½œï¼
                </div>
            </div>

            <!-- æ“ä½œæŒ‰éˆ•å€ -->
            <div class="grid grid-cols-5 gap-2 mt-4">
                <button onclick="calculateStrategy()" class="col-span-3 bg-slate-900 hover:bg-black text-white font-bold py-4 rounded-xl shadow-lg transition-all active:scale-95 text-lg tracking-widest border border-slate-700">
                    åŸ·è¡Œå¯¦æˆ°æ¨æ¼”
                </button>
                <button onclick="clearInputs()" class="col-span-2 bg-gray-200 hover:bg-gray-300 text-gray-700 font-bold py-4 rounded-xl shadow-md transition-all active:scale-95 text-base border border-gray-300 flex items-center justify-center">
                    ğŸ”„ æ¸…é™¤é‡ç½®
                </button>
            </div>

            <!-- çµæœé¡¯ç¤ºå€ -->
            <div id="resultArea" class="hidden fade-in mt-4 pb-10">
                <div id="resultBox" class="p-5 rounded-xl border-l-8 shadow-md bg-white relative overflow-hidden">
                    <div class="relative z-10">
                        <div class="flex justify-between items-start mb-2">
                            <div>
                                <span id="stockBadge" class="bg-slate-800 text-white text-[10px] px-2 py-0.5 rounded font-bold mb-1 inline-block"></span>
                                <h2 id="resultTitle" class="text-xl font-black leading-tight"></h2>
                            </div>
                            <span id="resultIcon" class="text-3xl"></span>
                        </div>

                        <div class="mb-3 flex flex-wrap gap-2">
                            <span id="trendTag" class="text-xs font-bold px-2 py-1 rounded border"></span>
                            <span id="volTag" class="text-xs font-bold px-2 py-1 rounded border"></span>
                            <span id="patternTag" class="hidden text-xs font-bold px-2 py-1 rounded border"></span>
                        </div>
                        
                        <p id="resultAction" class="text-2xl font-black mb-3 border-b pb-2"></p>
                        
                        <!-- Nå­—æ¸¬å¹…ç›®æ¨™å€ -->
                        <div id="targetBox" class="hidden bg-green-50 p-3 rounded border border-green-200 mb-3 text-xs shadow-sm transition-all">
                            <h5 id="targetHeader" class="font-bold text-green-800 border-b border-green-200 pb-1 mb-2 flex justify-between">
                                <span>ğŸ¯ å‹•æ…‹æ¸¬å¹…ç›®æ¨™ (h2=<span id="valH2"></span>, L=<span id="valL"></span>)</span>
                                <span id="targetStatusBadge" class="text-[10px] bg-green-200 px-1 rounded text-green-800">Active</span>
                            </h5>
                            <div id="targetList" class="space-y-1 font-mono text-slate-700">
                                <div class="flex justify-between">
                                    <span>ä¸€é£½ (1N)ï¼š</span>
                                    <span class="font-bold text-green-700" id="target1"></span>
                                </div>
                                <div class="flex justify-between">
                                    <span>äºŒå (2N)ï¼š</span>
                                    <span class="font-bold text-green-700" id="target2"></span>
                                </div>
                                <div class="flex justify-between bg-green-100 -mx-1 px-1 rounded">
                                    <span class="font-bold text-purple-700">äº”å€ (5N)ï¼š</span>
                                    <span class="font-bold text-purple-700" id="target5"></span>
                                </div>
                            </div>
                            <div id="targetInvalidMsg" class="hidden mt-2 text-center bg-gray-200 text-gray-500 font-bold py-1 rounded text-xs border border-gray-300">
                                âŒ è·Œç ´è»‹ç©ºä½ï¼Œç›®æ¨™å·²æŠµéŠ·
                            </div>
                        </div>

                        <div id="inferenceBox" class="hidden bg-slate-50 p-2 rounded border border-slate-200 mb-3 text-xs font-mono text-slate-600"></div>

                        <div class="bg-white/60 p-3 rounded border border-slate-200 mb-4 backdrop-blur-sm shadow-sm">
                            <p class="text-[10px] text-slate-500 font-bold uppercase mb-1">â˜… æˆ°è¡“æŒ‡å¼• (Tactical Advice)</p>
                            <p id="resultAdvice" class="text-sm text-slate-800 font-medium leading-relaxed"></p>
                        </div>
                        
                        <div id="aiAnalysisBox" class="hidden mt-3 p-4 bg-indigo-50 border border-indigo-200 rounded-lg text-sm text-slate-700 shadow-inner relative">
                            <div class="absolute top-0 right-0 p-1 opacity-20 text-4xl">ğŸ¤–</div>
                            <h4 id="aiReportTitle" class="font-black text-indigo-900 mb-2 border-b border-indigo-200 pb-1 flex items-center">
                                ğŸ§  çŸ³é ­æˆ°ç•¥åˆ†æå ±å‘Š
                            </h4>
                            <div id="aiContent" class="ai-content">
                                <!-- AI Content will be injected here -->
                            </div>
                            <div id="aiLoading" class="hidden flex flex-col items-center justify-center py-4">
                                <div class="dot-flashing"></div>
                                <p class="text-xs text-indigo-400 mt-3 animate-pulse">æ­£åœ¨è§£è®€ç›¤å‹¢å¿ƒç†...</p>
                            </div>
                        </div>

                        <div class="mt-2">
                             <button onclick="copyReport()" id="copyBtn" class="w-full flex items-center justify-center space-x-2 bg-slate-100 hover:bg-slate-200 text-slate-700 font-bold py-3 px-4 rounded-lg transition-colors text-sm border border-slate-300 shadow-sm">
                                <span>ğŸ“‹ è¤‡è£½å®Œæ•´æˆ°å ±</span>
                            </button>
                        </div>

                    </div>
                </div>
            </div>

            <!-- API Key è¨­å®šå€ (é¸ç”¨) -->
            <details class="group mt-4 bg-gray-50 rounded-lg border border-gray-200 overflow-hidden">
                <summary class="flex justify-between items-center font-bold text-gray-700 p-3 cursor-pointer hover:bg-gray-100">
                    <span>âš™ï¸ è¨­å®š API Key (é¸ç”¨ï¼šè§£é– AI åŠŸèƒ½)</span>
                    <span class="text-gray-400 transition-transform group-open:rotate-180">â–¼</span>
                </summary>
                <div class="p-3 bg-white">
                    <p class="text-xs text-gray-500 mb-2">æœ¬ç³»çµ±å·²å…§å»ºã€ŒçŸ³é ­æˆ°ç•¥é‚è¼¯åº«ã€ï¼Œä¸éœ€ Key ä¹Ÿèƒ½ç”¢å‡ºå®Œæ•´å ±å‘Šï¼<br>
                    <span class="text-indigo-600 font-bold">âœ¨ è‹¥éœ€å•Ÿç”¨ã€Œå®Œæ•´ AI åˆ†æã€ï¼Œè«‹å¡«å…¥ Gemini API Keyã€‚</span></p>
                    <input type="password" id="userApiKey" class="w-full p-2 border border-gray-300 rounded text-sm mb-2" placeholder="è²¼ä¸Š API Key (é¸å¡«)">
                    <button onclick="saveApiKey()" class="bg-gray-800 text-white text-xs px-3 py-1.5 rounded hover:bg-gray-900 transition-colors w-full">ğŸ’¾ å„²å­˜è¨­å®š</button>
                </div>
            </details>

        </div>
    </div>

    <script>
        const apiKey = ""; // Keep empty for local usage logic
        let baseReportText = "";
        let aiReportContent = "";
        let currentSimulationType = null; // Track current simulation mode

        // åˆå§‹åŒ–ï¼šè®€å–å„²å­˜çš„ API Key
        document.addEventListener('DOMContentLoaded', () => {
            const savedKey = localStorage.getItem('gemini_api_key');
            if (savedKey) {
                document.getElementById('userApiKey').value = savedKey;
            }
            
            // Add listeners to input fields to reset simulation type on manual edit
            document.querySelectorAll('input').forEach(input => {
                input.addEventListener('input', () => {
                    if (currentSimulationType) {
                        currentSimulationType = null;
                    }
                });
            });
        });
        
        // --- æ ¸å¿ƒè¤‡è£½åŠŸèƒ½ (V12.9.1 iOS ä¿®æ­£ç‰ˆ) ---
        async function copyReport() {
            if (!baseReportText) {
                alert("è«‹å…ˆåŸ·è¡Œé‹ç®—ä»¥ç”Ÿæˆæˆ°å ±ï¼");
                return;
            }

            let fullReport = baseReportText;
            if (aiReportContent) {
                // FIXED: Explicitly add the header for the AI section
                fullReport += `\n\nã€å››ã€ğŸ§  çŸ³é ­æˆ°ç•¥åˆ†æå ±å‘Šã€‘\n${aiReportContent}`;
            }

            try {
                await navigator.clipboard.writeText(fullReport);
                showCopySuccess();
                return;
            } catch (err) {
                console.warn('Clipboard API failed, trying fallback...', err);
            }

            const textarea = document.createElement('textarea');
            textarea.value = fullReport;
            textarea.style.position = 'fixed'; 
            textarea.style.bottom = '0';
            textarea.style.left = '0';
            textarea.style.width = '2em';
            textarea.style.height = '2em';
            textarea.style.padding = '0';
            textarea.style.border = 'none';
            textarea.style.outline = 'none';
            textarea.style.boxShadow = 'none';
            textarea.style.background = 'transparent';
            textarea.setAttribute('readonly', '');
            document.body.appendChild(textarea);

            if (navigator.userAgent.match(/ipad|iphone/i)) {
                const range = document.createRange();
                range.selectNodeContents(textarea); 
                const selection = window.getSelection();
                selection.removeAllRanges();
                selection.addRange(range);
                textarea.setSelectionRange(0, 999999);
            } else {
                textarea.select();
            }

            try {
                const successful = document.execCommand('copy');
                if (successful) showCopySuccess();
                else alert('è¤‡è£½å¤±æ•—ï¼Œè«‹é•·æŒ‰æ–‡å­—æ‰‹å‹•è¤‡è£½');
            } catch (err) {
                alert('è¤‡è£½å¤±æ•—ï¼Œç€è¦½å™¨ä¸æ”¯æ´');
            }

            document.body.removeChild(textarea);
        }

        function showCopySuccess() {
           const btn = document.getElementById('copyBtn');
           const originalText = btn.innerHTML;
           btn.innerHTML = '<span class="text-green-600">âœ… å·²è¤‡è£½åˆ°å‰ªè²¼ç°¿ï¼</span>';
           setTimeout(() => btn.innerHTML = originalText, 2000);
        }
        
        window.copyReport = copyReport;

        function saveApiKey() {
            const key = document.getElementById('userApiKey').value.trim();
            if (key) {
                localStorage.setItem('gemini_api_key', key);
                alert("âœ… API Key å·²å„²å­˜ï¼å·²å•Ÿç”¨å¢å¼·ç‰ˆ AI åˆ†æåŠŸèƒ½ã€‚");
            } else {
                localStorage.removeItem('gemini_api_key');
                alert("âš ï¸ API Key å·²æ¸…é™¤ï¼Œå°‡åˆ‡æ›å›å…§å»ºæˆ°ç•¥é‚è¼¯åº«ã€‚");
            }
        }

        function simulate(type) {
            clearInputs(false); 
            currentSimulationType = type; 

            if (type === 'strong') {
                document.getElementById('stockName').value = "æ¨¡æ“¬å€‹è‚¡ (TEST)";
                document.getElementById('high3d').value = 100;
                document.getElementById('low3d').value = 90; 
                document.getElementById('avgVol').value = 1000;
                setStatus('RED');
                document.getElementById('closePrice').value = 108;
                document.getElementById('todayHigh').value = 108; 
                document.getElementById('breakoutLow').value = 98; 
                document.getElementById('todayVol').value = 2000;
                document.getElementById('prevClose').value = 100; 
                document.getElementById('todayLow').value = 105;
                document.getElementById('prevLow').value = 98;
            } else if (type === 'break') {
                document.getElementById('stockName').value = "æ¨¡æ“¬å€‹è‚¡ (TEST)";
                document.getElementById('high3d').value = 100;
                document.getElementById('low3d').value = 90; 
                document.getElementById('avgVol').value = 1000;
                setStatus('GREEN'); 
                document.getElementById('closePrice').value = 103;
                document.getElementById('todayHigh').value = 103;
                document.getElementById('breakoutLow').value = 100;
                document.getElementById('todayVol').value = 1500;
            } else if (type === 'crash') {
                document.getElementById('stockName').value = "æ¨¡æ“¬å€‹è‚¡ (TEST)";
                document.getElementById('high3d').value = 100;
                document.getElementById('low3d').value = 90; 
                document.getElementById('avgVol').value = 1000;
                setStatus('RED'); 
                document.getElementById('closePrice').value = 85; 
                document.getElementById('todayHigh').value = 92;
                document.getElementById('breakoutLow').value = 95; 
                document.getElementById('todayVol').value = 3000;
            } else if (type === 'flat') {
                document.getElementById('stockName').value = "æ¨¡æ“¬å€‹è‚¡ (TEST)";
                document.getElementById('high3d').value = 100;
                document.getElementById('low3d').value = 90; 
                document.getElementById('avgVol').value = 1000;
                setStatus('GREEN');
                document.getElementById('closePrice').value = 98; 
                document.getElementById('todayHigh').value = 99;
                document.getElementById('breakoutLow').value = 95;
                document.getElementById('todayVol').value = 600;
            }

            const inputs = document.querySelectorAll('input[type="number"]');
            inputs.forEach(input => {
                input.classList.remove('highlight-input');
                void input.offsetWidth;
                input.classList.add('highlight-input');
            });
            
            setTimeout(() => {
                calculateStrategy();
                const resultArea = document.getElementById('resultArea');
                resultArea.classList.remove('hidden');
                resultArea.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }, 100);
        }

        const checkboxes = document.querySelectorAll('#sellChecklist input[type="checkbox"]');
        const adviceBox = document.getElementById('sellAdvice');
        checkboxes.forEach(chk => {
            chk.addEventListener('change', () => {
                const allChecked = Array.from(checkboxes).every(c => c.checked);
                if (allChecked) adviceBox.classList.remove('hidden');
                else adviceBox.classList.add('hidden');
            });
        });

        function toggleEncyclopedia() {
            const content = document.getElementById('encyclopediaContent');
            content.classList.toggle('hidden');
        }

        function clearInputs(hideResult = true) {
            document.querySelectorAll('input[type="text"], input[type="number"]').forEach(input => input.value = '');
            document.querySelectorAll('input[type="checkbox"]').forEach(box => box.checked = false);
            adviceBox.classList.add('hidden');
            document.getElementById('aiAnalysisBox').classList.add('hidden');
            document.getElementById('aiContent').innerHTML = '';
            aiReportContent = ""; 
            currentSimulationType = null; 
            if(hideResult) document.getElementById('resultArea').classList.add('hidden');
            setStatus('GREEN');
            if(hideResult) window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function formatNumber(num) {
            return num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
        }
        function formatPrice(num) {
            return parseFloat(num).toFixed(2);
        }
        function setStatus(status) {
            document.getElementById('currentStatus').value = status;
            document.getElementById('btn-green').className = status === 'GREEN' ? "py-3 px-4 border-2 rounded-lg font-bold transition-all border-green-500 bg-green-50 text-green-700 shadow-inner ring-2 ring-green-100 opacity-100" : "py-3 px-4 border-2 rounded-lg font-bold transition-all border-slate-200 text-slate-400 hover:bg-slate-50 opacity-60";
            document.getElementById('btn-red').className = status === 'RED' ? "py-3 px-4 border-2 rounded-lg font-bold transition-all border-red-500 bg-red-50 text-red-700 shadow-inner ring-2 ring-red-100 opacity-100" : "py-3 px-4 border-2 rounded-lg font-bold transition-all border-slate-200 text-slate-400 hover:bg-slate-50 opacity-60";
            
            if(status === 'GREEN') {
                document.getElementById('advancedInputs').classList.add('hidden');
                document.getElementById('sellChecklist').classList.add('hidden');
            } else {
                document.getElementById('advancedInputs').classList.remove('hidden');
                document.getElementById('sellChecklist').classList.remove('hidden');
            }
        }

        function calculateStrategy() {
            document.querySelectorAll('input').forEach(el => el.classList.remove('input-error'));
            document.getElementById('aiAnalysisBox').classList.add('hidden');
            document.getElementById('aiContent').innerHTML = '';
            aiReportContent = "";

            // Use the generic logic, but also support manual overrides
            // If currentSimulationType is set, force that type.
            // Otherwise, determine type from user inputs dynamically.
            
            const stockName = document.getElementById('stockName').value || "æœªè¼¸å…¥è‚¡å";
            const status = document.getElementById('currentStatus').value;
            const close = parseFloat(document.getElementById('closePrice').value);
            const todayH = parseFloat(document.getElementById('todayHigh').value); 
            const high3d = parseFloat(document.getElementById('high3d').value); 
            const L = parseFloat(document.getElementById('low3d').value);    
            const breakoutLow = parseFloat(document.getElementById('breakoutLow').value); 
            const todayVol = parseFloat(document.getElementById('todayVol').value);
            const avgVol = parseFloat(document.getElementById('avgVol').value);
            const isFullSell = Array.from(checkboxes).every(c => c.checked);
            const prevClose = parseFloat(document.getElementById('prevClose').value);
            const todayLow = parseFloat(document.getElementById('todayLow').value);
            const prevLow = parseFloat(document.getElementById('prevLow').value);
            const prevLongRedLow = parseFloat(document.getElementById('prevLongRedLow').value);

            let hasError = false;
            let errorMsg = "è«‹æª¢æŸ¥ç´…æ¡†æ¬„ä½ï¼š\n";
            if (!status) { errorMsg += "- è«‹é¸æ“‡ç›®å‰ç‹€æ…‹\n"; hasError = true; }
            if (isNaN(close)) { document.getElementById('closePrice').classList.add('input-error'); errorMsg += "- è«‹è¼¸å…¥ç›®å‰åƒ¹\n"; hasError = true; }
            if (isNaN(high3d)) { document.getElementById('high3d').classList.add('input-error'); errorMsg += "- è«‹è¼¸å…¥å‰ä¸‰é«˜\n"; hasError = true; }
            if (isNaN(L)) { document.getElementById('low3d').classList.add('input-error'); errorMsg += "- è«‹è¼¸å…¥å‰ä¸‰ä½\n"; hasError = true; }
            if (hasError) { alert(errorMsg); return; }

            let h2 = isNaN(todayH) ? close : todayH; 
            if(h2 < close) h2 = close;
            const gap = h2 - L;
            let target1 = 0, target2 = 0, target5 = 0;
            let isTargetValid = true;
            if (!isNaN(breakoutLow) && close < breakoutLow) isTargetValid = false; 

            if (gap > 0) {
                target1 = h2 + gap;
                target2 = h2 + (2 * gap);
                target5 = h2 + (5 * gap);
                document.getElementById('valH2').innerText = h2;
                document.getElementById('valL').innerText = L;
                document.getElementById('target1').innerText = formatPrice(target1);
                document.getElementById('target2').innerText = formatPrice(target2);
                document.getElementById('target5').innerText = formatPrice(target5);
                const targetBox = document.getElementById('targetBox');
                targetBox.classList.remove('hidden');
                if (isTargetValid) {
                    targetBox.className = "bg-green-50 p-3 rounded border border-green-200 mb-3 text-xs shadow-sm";
                    document.getElementById('targetList').classList.remove('invalid-target');
                    document.getElementById('targetInvalidMsg').classList.add('hidden');
                    document.getElementById('targetStatusBadge').innerText = "Active";
                    document.getElementById('targetStatusBadge').className = "text-[10px] bg-green-200 px-1 rounded text-green-800";
                } else {
                    targetBox.className = "bg-gray-100 p-3 rounded border border-gray-300 mb-3 text-xs shadow-sm opacity-75";
                    document.getElementById('targetList').classList.add('invalid-target');
                    document.getElementById('targetInvalidMsg').classList.remove('hidden');
                    document.getElementById('targetStatusBadge').innerText = "Invalid";
                    document.getElementById('targetStatusBadge').className = "text-[10px] bg-gray-300 px-1 rounded text-gray-700";
                }
            } else {
                document.getElementById('targetBox').classList.add('hidden');
            }

            // Determine Pattern Type for Standard Calculation
            let isStrong = false;
            let isBreakout = false;
            let isBreakdown = false;
            let determinedType = 'flat'; // default

            if (status === 'RED') {
                if (close < L) {
                    isBreakdown = true; 
                    determinedType = 'crash';
                } else {
                    if (!isNaN(prevClose) && !isNaN(todayLow) && !isNaN(prevLow)) {
                        if (close > prevClose && todayLow > prevLow) {
                            isStrong = true;
                            determinedType = 'strong';
                        } else if (close >= high3d) {
                            // Can be breakout or strong, let's say breakout if close to high3d, strong if way above?
                            // Actually 'breakout' is usually Day 1.
                            // If status is RED (Holding), it might be strong or breakout.
                            // Let's use Strong template for Holding RED.
                            determinedType = 'strong'; 
                        } else {
                            // Accumulation / Pan-Jian
                            determinedType = 'flat'; // Or a separate 'accumulation' type if we had one
                        }
                    } else {
                        if (close > high3d) {
                            determinedType = 'strong';
                        } else {
                            determinedType = 'flat';
                        }
                    }
                }
            } 
            
            if (isBreakdown || (status === 'RED' && close < L) || (status === 'GREEN' && close < L)) {
                  isBreakdown = true;
                  determinedType = 'crash';
            }

            if (status === 'GREEN' && close > high3d) {
                isBreakout = true; 
                determinedType = 'break';
            } else if (status === 'GREEN' && !isBreakout && !isBreakdown) {
                determinedType = 'flat';
            }

            // If explicit simulation, use that type. Otherwise use determined type from inputs.
            const typeToRender = currentSimulationType ? currentSimulationType : determinedType;
            
            // Map determinedType to specific styles for renderV16Simulation
            // Because renderV16Simulation now handles ALL logic dynamically based on inputs
            renderV16Simulation(typeToRender);
        }

        // --- New V16 Rendering Logic ---
        function renderV16Simulation(type) {
             const resultArea = document.getElementById('resultArea');
             resultArea.classList.remove('hidden');
             const resultBox = document.getElementById('resultBox');
             
             // Get values directly from inputs to make it dynamic (floating)
             const stockName = document.getElementById('stockName').value || "æ¨¡æ“¬å€‹è‚¡";
             const close = parseFloat(document.getElementById('closePrice').value);
             const todayH = parseFloat(document.getElementById('todayHigh').value); 
             const high3d = parseFloat(document.getElementById('high3d').value); 
             const L = parseFloat(document.getElementById('low3d').value);    
             const breakoutLow = parseFloat(document.getElementById('breakoutLow').value); 
             const avgVol = parseFloat(document.getElementById('avgVol').value);
             
             // Calculations for dynamic text
             const gap = todayH - L;
             const target1 = todayH + gap;
             const target2 = todayH + (2 * gap);
             const target5 = todayH + (5 * gap);
             
             const v_break = Math.round(avgVol * 1.3);
             const v_strong = Math.round(avgVol * 1.5);
             const v_wash = Math.round(avgVol * 0.8);
             
             // Base Report Text Variables
             let rTitleText = "", rActionText = "", rBoxClass = "", rTitleClass = "", rActionClass = "", rIconText = "", rTrendText = "", rVolText = "", rAdviceText = "", rInfText = "";
             let v16BaseReport = "";
             let v16AIReport = "";

             // Helper for safe formatting
             const fP = (num) => isNaN(num) ? "---" : formatPrice(num);
             const fN = (num) => isNaN(num) ? "---" : formatNumber(num);

             if (type === 'strong') {
                rTitleText = "ğŸ”¥ å¼·è»‹ç©ºç›¤";
                rActionText = "æ­»æŠ±ä¸æ”¾ (é™æ¨¡æ“¬æ¥µå¼·æ¨¡çµ„)";
                rBoxClass = "bg-red-100 border-red-600";
                rTitleClass = "text-xl font-bold text-red-700";
                rActionClass = "text-2xl font-black text-red-800 border-b border-red-300 pb-2 mb-2";
                rIconText = "ğŸ’";
                rTrendText = "ğŸ”¥ å¼·è»‹ç©ºç›¤ (ä¸»åŠ›é–ç¢¼)";
                rVolText = "æ¥µå¼·æ”»æ“Šé‡ (1.5 å€â†‘)";
                
                const washPrice7 = (close * 0.93).toFixed(2); // 7% down

                v16BaseReport = `1. ã€æ¨¡æ“¬æ¥µå¼·ã€‘(å¤šé ­æœ€å¼·å‹¢ - ç²åˆ©æ¥µå¤§åŒ–)
âš ï¸ æ¨¡çµ„åˆ‡æ›åŸå‰‡ï¼š
ã€Œçªç ´ â†’ æ¥µå¼·ã€éœ€æ»¿è¶³é€£çºŒæ”»æ“Šé‡èˆ‡çµæ§‹ä¸ç ´
ã€Œæ¥µå¼· â†’ ç›¤æ•´ã€ä»¥é‡å¤§ä¸æ¼² / å‹•èƒ½éˆåŒ–ç‚ºåˆ¤æº–
ã€Œç›¤æ•´ â†’ å¤§è·Œã€ä»¥å¸¶é‡ç ´ç®±åº•ç‚ºç¢ºèª
ç¦æ­¢è·¨æ¨¡çµ„æ··ç”¨æŒ‡ä»¤
âš ï¸ æœ¬æ¨¡çµ„åƒ…åœ¨ç›¤å‹¢å±¬æ–¼ã€æ¨¡æ“¬æ¥µå¼·ã€‘éšæ®µä¸”çµæ§‹ä¸ç ´è»‹ç©ºä½é»æ™‚é©ç”¨
å—¨ï¼Œæˆ‘æ˜¯çŸ³é ­ï¼Œå¸Œæœ›æˆ‘çš„ N å­—æˆ°æ³•åˆ†æç³»çµ±èƒ½è®“ä½ å¤§å¹…æå‡å‹ç‡ğŸ“ˆğŸ’¯
N å­—æˆ°æ³•æŒ‡æ®ä¸­å¿ƒ by.çŸ³é ­ V16.1
ã€Œæœ¬ç­–ç•¥åƒ…ç‚ºå€‹äººåˆ†æåƒè€ƒï¼ŒæŠ•è³‡æœ‰é¢¨éšªï¼Œæ“ä½œéœ€è‡ªè² ç›ˆè™§ã€
è‚¡åï¼š${stockName}
ã€ä¸€ã€å€‹è‚¡ç¾æ³åˆ†æã€‘
ğŸ“Œ æ“ä½œæŒ‡ä»¤ï¼šã€ æ­»æŠ±ä¸æ”¾ï¼ˆé™æ¨¡æ“¬æ¥µå¼·æ¨¡çµ„ï¼‰ ã€‘
(è«‹ç¢ºèªæ¨¡çµ„ç‹€æ…‹ç¬¦åˆæ¢ä»¶å†æ“ä½œ)
âš¡ é‡èƒ½ç‹€æ…‹ï¼š æ¥µå¼·æ”»æ“Šé‡ (1.5 å€â†‘)
ğŸ’° ç•¶å‰ç¾åƒ¹ï¼š ${fP(close)}
ğŸ“‰ 7% æ´—ç›¤ï¼šè·Œåˆ°${washPrice7}$ (ç•¶æ—¥ç›¤ä¸­æœ€å¤§å®¹å¿å€¼)
ğŸ“ˆ ç›¤å‹¢å‹æ…‹ï¼š ğŸ”¥ å¼·è»‹ç©ºç›¤ (ä¸»åŠ›é–ç¢¼)
âœ… æ³¢æ®µç›®æ¨™ï¼š 5N (${fP(target5)})
âš ï¸ çµæ§‹é˜²å®ˆï¼š ${fP(breakoutLow)} (ä»¥æ”¶ç›¤åƒ¹ç‚ºæœ€çµ‚åˆ¤æº–ï¼Œä¸ç ´æ­¤é»ä¸Šè¿°ç›®æ¨™æ‰æœ‰æ•ˆ)
âš ï¸ æé†’ï¼šã€Œæ­»æŠ±ã€åƒ…é©ç”¨æ–¼ç›¤å‹¢ä»å±¬æ–¼ã€æ¨¡æ“¬æ¥µå¼·ã€‘æœŸé–“ï¼Œä¸€æ—¦ç›¤å‹¢é™ç´šï¼Œè©²æŒ‡ä»¤ç«‹å³å¤±æ•ˆã€‚
â˜… é‡åƒ¹æ¨æ¼” (å‡é‡æŒ‡éå» 5 æ—¥å¹³å‡æˆäº¤é‡ ${fN(avgVol)})ï¼š
ğŸ”¥ æ”»æ“Šé–€æª» (1.3x)ï¼š${fN(v_break)}ï¼ˆé”æ¨™ï¼‰âœ…
ğŸš¿ æ´—ç›¤é–€æª» (0.8x)ï¼š${fN(v_wash)}
ğŸ“Œ å°çµï¼š æœ¬æª”ã€Œ${stockName}ã€è™•æ–¼ä¸»å‡æ®µï¼Œæ­¤æ™‚æœ€å¤§çš„æ•µäººï¼Œä»ç„¶æ˜¯ã€Œæƒ³ææ—©ä¸‹è»Šçš„è‡ªå·±ã€ã€‚
ğŸ¯ å‹•æ…‹æ¸¬å¹…åŸºæº– (èµ·é»ä»¥ ${fP(L)} ç‚ºä¾‹ï¼Œh2 = ${fP(todayH)}ï¼Œå…¬å¼ï¼šç›®æ¨™åƒ¹ = h2 + N Ã— (h2 - èµ·é»))
ä¸€é£½ (1N)ï¼š ${fP(target1)}ï¼ˆéè³£é»ï¼Œåƒ…æ¸¬å¹…ï¼‰
äºŒå (2N)ï¼š ${fP(target2)}ï¼ˆåŠ ç¢¼å–®å¯æ¸›ç¢¼ï¼‰
äº”å€ (5N)ï¼š ${fP(target5)}ï¼ˆæ³¢æ®µçµ‚æ¥µç›®æ¨™ï¼‰
ã€äºŒã€æ˜æ—¥é–‹ç›¤ãƒ»é‡èƒ½ä½œæˆ°åŠ‡æœ¬ã€‘
ğŸ’¡ æˆ°è¡“å°å¡ï¼š é ä¼°é‡ = 09:15 æˆäº¤é‡ Ã— 8
âš ï¸ é€²éšé‡èƒ½æé†’ï¼š
é€™æ˜¯ä¸€å€‹é€šç”¨çš„ç¶“é©—æ³•å‰‡ï¼Œä½†æœ‰äº›å€‹è‚¡ï¼ˆç‰¹åˆ¥æ˜¯ä¸­å°å‹é£†è‚¡ï¼‰åœ¨ 09:30 ä¹‹å¾Œé‡èƒ½æœƒå¿«é€Ÿèç¸®ï¼Œæˆ–è€…åœ¨å°¾ç›¤æ‰å·è¥²ã€‚
é‚è¼¯è£œå……ï¼š å¦‚æœæ˜¯é‡å°æ–°æ‰‹ï¼Œç¶­æŒé€™å€‹ç°¡å–®è¦å‰‡å¾ˆå¥½ï¼›å¦‚æœæ˜¯é€²éšæ“ä½œï¼Œè«‹æ³¨æ„**ã€Œç›¤ä¸­è‹¥é‡èƒ½æ€¥å‡ï¼ˆé ä¼°é‡å¿«é€Ÿä¸‹ä¿®ï¼‰ï¼Œéœ€é‡æ–°è©•ä¼°åŠ‡æœ¬ã€**ã€‚
ğŸ”´ åŠ‡æœ¬ Aï¼ˆæ¥µå¼·é–æ”»ï¼‰
ğŸ”¹ é˜²å®ˆåƒ¹ï¼š${fP(breakoutLow)}
ğŸ”¹ æ¢ä»¶ï¼š é ä¼°é‡ > ${fN(v_strong)} å¼µ (1.5xâ†‘)
ğŸ‘‰ æŒ‡ä»¤ï¼š æŠ±ç·Š (Hold)ï¼Œè‹¥ç›´æ¥é–æ¼²åœï¼Œæ’éšŠå°å¹…åŠ ç¢¼ã€‚(è«‹ç¢ºèªæ¨¡çµ„ç‹€æ…‹ç¬¦åˆæ¢ä»¶å†æ“ä½œ)
ğŸŸ¢ åŠ‡æœ¬ Bï¼ˆçºŒå¼·æ¨é€²ï¼‰
ğŸ”¹ é˜²å®ˆåƒ¹ï¼š${fP(breakoutLow)}
ğŸ”¹ æ¢ä»¶ï¼š é ä¼°é‡ ${fN(v_break)}ï½${fN(v_strong)} å¼µ (1.3x ~ 1.5x)
ğŸ‘‰ æŒ‡ä»¤ï¼š çºŒæŠ± (Hold)ï¼Œç›¤ä¸­éœ‡ç›ªå±¬æ–¼å¥åº·æ›æ‰‹ã€‚(è«‹ç¢ºèªæ¨¡çµ„ç‹€æ…‹ç¬¦åˆæ¢ä»¶å†æ“ä½œ)
ğŸŸ¡ åŠ‡æœ¬ Cï¼ˆé‡ç¸®æ•´ç†ï¼‰
ğŸ”¹ é˜²å®ˆåƒ¹ï¼š${fP(breakoutLow)}
ğŸ”¹ æ¢ä»¶ï¼š é ä¼°é‡ < ${fN(v_wash)} å¼µ (0.8xâ†“)
âš ï¸ è¨»ï¼šæ¥µå¼·ç›¤é‡ç¸®æ¨™æº–ç‚º <0.8xï¼Œèˆ‡ç›¤æ•´ç›¤ä¸åŒã€‚
ğŸ‘‰ æŒ‡ä»¤ï¼š çºŒæŠ± (Hold)ã€‚å¾ŒçºŒè‹¥ã€Œå†å‡ºé‡ã€ç«™ç©©ç•¶æ—¥å‡åƒ¹ç·šï¼Œæ–¹å¯åŠ ç¢¼ã€‚
âš« åŠ‡æœ¬ Dï¼ˆé«˜æª”è­¦è¨Šï¼‰
ğŸ”¹ é˜²å®ˆåƒ¹ï¼š${fP(breakoutLow)}
ğŸ”¹ æ¢ä»¶ï¼š çˆ†é‡ (> ${fN(Math.round(avgVol * 2))} å¼µï¼Œç´„ 2.0xâ†‘) ä¸”æ”¶é»‘ K
ğŸ‘‰ æŒ‡ä»¤ï¼š æ¸›ç¢¼ (Trim)ï¼Œé«˜æª”çˆ†é‡ç‚ºæ½›åœ¨å‡ºè²¨å‰å…†ã€‚(è«‹ç¢ºèªæ¨¡çµ„ç‹€æ…‹ç¬¦åˆæ¢ä»¶å†æ“ä½œ)
âš ï¸ å¯¦æˆ°ç°è‰²åœ°å¸¶è£œå¼· (SOP å¤–çš„æ‡‰è®Š)
é‡åƒ¹èƒŒé›¢çš„ç°è‰²å€ï¼ˆåŠ‡æœ¬ A èˆ‡ B ä¹‹é–“ï¼‰ï¼š
ç‹€æ³ï¼š é‡èƒ½é ä¼°è½åœ¨ ${fN(v_break)}~${fN(v_strong)} å¼µï¼ˆæ”»æ“Šé‡ï¼‰ï¼Œä½†åƒ¹æ ¼å»è»Ÿè…³è·Œè‡³ ${fP(close*0.97)}~${fP(close*0.99)}ã€‚
æ‡‰è®Šï¼š æš«ä¸åŠ ç¢¼ã€‚é›–ç„¶æœ‰é‡ï¼Œä½†åƒ¹æ ¼ä¸å¼·ï¼Œåƒ…è§€å¯Ÿæ˜¯å¦ç‚ºæ›æ‰‹æ´—ç›¤ã€‚
é‡ç¸®çš„çœŸå‡åˆ¤æ–·ï¼ˆåŠ‡æœ¬ C çš„ç´°ç¯€ï¼‰ï¼š
ç‹€æ³ï¼š é ä¼°é‡ < ${fN(v_wash)} å¼µï¼ˆé‡ç¸®ï¼‰ã€‚
æ‡‰è®Šï¼š
è‹¥åƒ¹æ ¼ä» > ${fP(breakoutLow)} (çµæ§‹é˜²å®ˆé») â†’ å¥åº·æ´—ç›¤ï¼ŒçºŒæŠ±ã€‚
è‹¥åƒ¹æ ¼è·Œç ´ ${fP(breakoutLow)} â†’ å‹•èƒ½æ¸›å¼±ï¼Œè€ƒæ…®é™ç¢¼ã€‚
ç›¤ä¸­æ€¥æ®ºçš„å¹…åº¦å®šç¾©ï¼š
ç‹€æ³ï¼š ç›¤ä¸­æ€¥æ®ºå¹…åº¦åœ¨ 7%~8% ä¹‹é–“ï¼ˆä»¥ç•¶å‰è‚¡åƒ¹ ${fP(close)} è¨ˆç®—ç´„ä¾†åˆ° ${washPrice7} å…ƒé™„è¿‘ï¼‰ï¼Œå°šæœªè§¸åŠ ${fP(breakoutLow)} é˜²å®ˆé»ã€‚
æ‡‰è®Šï¼š åš´å®ˆæ”¶ç›¤åƒ¹ã€‚ç›¤ä¸­ä¸ææ…Œæ®ºä½ï¼Œè‹¥æ”¶ç›¤ç„¡æ³•æ‹‰å› ${washPrice7} ä»¥ä¸Šï¼Œè¦–ç‚ºè½‰å¼±è¨Šè™Ÿã€‚
ã€ä¸‰ã€ğŸ“Œ æ¥µå¼·ç›¤æ“ä½œç­–ç•¥å°ˆå±¬ãƒ»é—œéµä¸‰å•ã€‘
â“ Q1ï¼šæ¼²é€™éº¼å¤šäº†ï¼Œæˆ‘å¾ˆæ€•ï¼Œèƒ½ä¸èƒ½å…ˆè³£ä¸€è¶Ÿï¼Ÿ
é‚è¼¯èªªæ˜ï¼ˆä¸å»ºè­°éæ—©ä¸‹è»Šï¼‰ï¼š åœ¨è»‹ç©ºä¸»å‡æ®µä¸­ï¼Œæœ€å®¹æ˜“çŠ¯çš„éŒ¯èª¤æ˜¯ã€Œå› ç‚ºæ€•é«˜è€Œè³£åœ¨ä¸»å‡æ®µä¸­é€”ã€ã€‚åªè¦æœªå‡ºç¾å¦æ±ºæ¢æ¬¾ï¼Œç¾åœ¨è³£å‡ºï¼Œå¾ŒçºŒæ¼²å¹…å°‡èˆ‡ä½ ç„¡é—œã€‚
æ“ä½œå»ºè­°ï¼š
åƒ¹æ ¼æœªè·Œç ´ ${fP(breakoutLow)} â†’ å …æŒæŠ±ï¼ˆHoldï¼‰
è‹¥å·²æ¼²è‡³ ${fP(target2)}~${fP(target5)} â†’ å¯è€ƒæ…®éƒ¨åˆ†æ¸›ç¢¼ï¼Œä½†ä»ä»¥çµæ§‹ä¸ç ´ç‚ºä¸»ã€‚
â“ Q2ï¼šç›¤ä¸­å¦‚æœæ€¥æ®ºè·³æ°´ï¼Œè¦ä¸è¦è·‘ï¼Ÿ
é‚è¼¯ï¼š çœ‹æ”¶ç›¤ï¼Œä¸çœ‹ç›¤ä¸­ã€‚å¼·å‹¢è‚¡å¸¸è¦‹ã€Œæ´—ç›¤æ€¥æ®ºã€ã€‚åªè¦æ”¶ç›¤æœªç ´çµæ§‹é˜²å®ˆï¼Œç›¤ä¸­æ€¥æ®ºå±¬æ–¼æ›æ‰‹èˆ‡æ´—ç±Œï¼Œä¸æ§‹æˆè¶¨å‹¢åè½‰ã€‚
â“ Q3ï¼šä»€éº¼æƒ…æ³ä¸‹ï¼Œæ­»æŠ±æœƒå¤±æ•ˆï¼Ÿ
æ¥µå¼·ç›¤å¦æ±ºæ¢æ¬¾ï¼ˆä»»ä¸€æˆç«‹ â†’ é™ç´šè™•ç†ï¼‰ï¼š
çˆ†é‡ä½†ç„¡æ³•å‰µé«˜ï¼š æˆäº¤é‡ â‰¥ ${fN(v_strong)} (1.5xâ†‘å‡é‡) ä½†è‚¡åƒ¹æœªå‰µæ–°é«˜ â†’ é™ç´šã€‚
é€£çºŒå…©æ—¥é‡å¢ï¼Œä½†é«˜é»åœæ»¯ï¼š é€£çºŒå…©æ—¥é‡å¢ï¼ˆ>${fN(v_break)} å¼µï¼‰ä½†é«˜é»æ¨ä¸å‹• â†’ é™ç´šã€‚
è·Œç ´çµæ§‹é˜²å®ˆé»ï¼š æ”¶ç›¤è·Œç ´ ${fP(breakoutLow)} â†’ å¿…é ˆæ¸›ç¢¼ã€‚`;

                v16AIReport = `(ä¸€) ä¸»åŠ›å¿ƒç†é€è¦–ï¼š ä¸»åŠ›ä»è™•æ–¼æ‹‰æŠ¬ä¸»å‡æ®µï¼Œä½†æœƒé€ééœ‡ç›ªèˆ‡æ´—ç›¤æ¸¬è©¦å¸‚å ´è€å¿ƒã€‚
(äºŒ) æ•£æˆ¶å¿ƒç†é™·é˜±ï¼š éæ—©ç²åˆ©äº†çµï¼›æŠŠã€Œæ¥µå¼·ç›¤ã€ç•¶æˆæ°¸é ä¸æœƒçµæŸçš„ä¿¡ä»°ã€‚
(ä¸‰) æ•™ç·´å¿ƒæ³•ï¼š ã€Œæ­»æŠ±æ˜¯ç´€å¾‹ï¼Œä¸æ˜¯ä¿¡ä»°ï¼›æŠ±çš„æ˜¯è¶¨å‹¢ï¼Œä¸æ˜¯å¹»æƒ³ã€‚ã€
(å››) çŸ³é ­æˆ°ç•¥çµè«–ï¼š
â— ç›¤å‹¢å®šèª¿ï¼š è»‹ç©ºä¸»å‡æ®µï¼ˆå°šæœªçµæŸï¼‰
ğŸ¯ æ ¸å¿ƒç­–ç•¥ï¼š
çµæ§‹ä¸ç ´ â†’ æŠ±
å‹•èƒ½éˆåŒ– â†’ é™
æ¨¡çµ„åˆ‡æ› â†’ å…¨é¢é‡æ–°è©•ä¼°`;

             } else if (type === 'break') {
                rTitleText = "ğŸ”¥ ä¸‰ç›¤çªç ´ (ç¿»ç´…)";
                rActionText = "ç©æ¥µé€²å ´";
                rBoxClass = "bg-red-50 border-red-500";
                rTitleClass = "text-xl font-bold text-red-600";
                rActionClass = "text-2xl font-black text-red-700 border-b border-red-200 pb-2 mb-2";
                rIconText = "ğŸš€";
                rTrendText = "ğŸš€ çªç ´é ¸ç·š (Nå­—èµ·é»)";
                rVolText = "å¸¶é‡çªç ´ (Day 1)";

                v16BaseReport = `2. ã€æ¨¡æ“¬çªç ´ã€‘(èµ·æ¼²ç¬¬ä¸€å¤©)
âš ï¸ æ¨¡çµ„åˆ‡æ›åŸå‰‡ï¼š
ã€Œçªç ´ â†’ æ¥µå¼·ã€éœ€æ»¿è¶³é€£çºŒæ”»æ“Šé‡èˆ‡çµæ§‹ä¸ç ´
ã€Œæ¥µå¼· â†’ ç›¤æ•´ã€ä»¥é‡å¤§ä¸æ¼² / å‹•èƒ½éˆåŒ–ç‚ºåˆ¤æº–
ã€Œç›¤æ•´ â†’ å¤§è·Œã€ä»¥å¸¶é‡ç ´ç®±åº•ç‚ºç¢ºèª
ç¦æ­¢è·¨æ¨¡çµ„æ··ç”¨æŒ‡ä»¤
âš ï¸ æœ¬æ¨¡çµ„åƒ…åœ¨è‚¡åƒ¹å¸¶é‡çªç ´é ¸ç·šä¸”çªç ´ç¢ºèªæˆç«‹æ™‚é©ç”¨
å—¨ï¼Œæˆ‘æ˜¯çŸ³é ­ï¼Œå¸Œæœ›æˆ‘çš„ N å­—æˆ°æ³•åˆ†æç³»çµ±èƒ½è®“ä½ å¤§å¹…æå‡å‹ç‡ğŸ“ˆğŸ’¯
N å­—æˆ°æ³•æŒ‡æ®ä¸­å¿ƒ by.çŸ³é ­ V16.1
ã€Œæœ¬ç­–ç•¥åƒ…ç‚ºå€‹äººåˆ†æåƒè€ƒï¼ŒæŠ•è³‡æœ‰é¢¨éšªï¼Œæ“ä½œéœ€è‡ªè² ç›ˆè™§ã€
è‚¡åï¼š${stockName}
ã€ä¸€ã€å€‹è‚¡ç¾æ³åˆ†æã€‘
ğŸ“Œ æ“ä½œæŒ‡ä»¤ï¼šã€ ç©æ¥µé€²å ´ ã€‘
(è«‹ç¢ºèªæ¨¡çµ„ç‹€æ…‹ç¬¦åˆæ¢ä»¶å†æ“ä½œ)
âš¡ é‡èƒ½ç‹€æ…‹ï¼š å¸¶é‡çªç ´ (Day 1)
ğŸ’° ç•¶å‰ç¾åƒ¹ï¼š ${fP(close)}
ğŸ›¡ï¸ é˜²å®ˆé ¸ç·šï¼š ${fP(breakoutLow)} (è·³ç©ºç¼ºå£æˆ–é ¸ç·š)
ğŸ“ˆ ç›¤å‹¢å‹æ…‹ï¼š ğŸš€ çªç ´é ¸ç·š (Nå­—èµ·é»)
âœ… ç›®æ¨™ç›´æŒ‡ï¼š 1N (${fP(target1)})
â˜… é‡åƒ¹æ¨æ¼” (å‡é‡æŒ‡éå» 5 æ—¥å¹³å‡æˆäº¤é‡ ${fN(avgVol)})ï¼š
ğŸ”¥ æ”»æ“Šé–€æª» (1.3x)ï¼š${fN(v_break)}ï¼ˆé”æ¨™ï¼‰âœ…
ğŸš¿ æ´—ç›¤é–€æª» (0.8x)ï¼š${fN(v_wash)}
ğŸ“Œ å°çµï¼š æœ¬æª”ã€Œ${stockName}ã€ä»Šæ—¥æ­£å¼è¡¨æ…‹ï¼Œè„«é›¢ç›¤æ•´å€ï¼Œç‚ºæœ€ä½³é€²å ´æ™‚æ©Ÿã€‚
ğŸ¯ å‹•æ…‹æ¸¬å¹…åŸºæº– (èµ·é»ä»¥ ${fP(L)} ç‚ºä¾‹ï¼Œh2 = ${fP(todayH)}ï¼Œå…¬å¼ï¼šç›®æ¨™åƒ¹ = h2 + N Ã— (h2 - èµ·é»))
ä¸€é£½(1N)ï¼š ${fP(target1)} (åˆæ­¥ç²åˆ©é»)
äºŒå(2N)ï¼š ${fP(target2)} (åŠ ç¢¼å–®æ¸›ç¢¼é»)
äº”å€(5N)ï¼š ${fP(target5)} (æ³¢æ®µçµ‚æ¥µç›®æ¨™)
ã€äºŒã€æ˜æ—¥é–‹ç›¤ãƒ»é‡èƒ½ä½œæˆ°åŠ‡æœ¬ã€‘
ğŸ’¡ æˆ°è¡“å°å¡ï¼š é ä¼°é‡ = 09:15 æˆäº¤é‡ Ã— 8
ğŸ”´ åŠ‡æœ¬ A (è·³ç©ºé–‹é«˜)
ğŸ”¹ é˜²å®ˆåƒ¹ï¼š${fP(breakoutLow)}
ğŸ”¹ æ¢ä»¶ï¼š é ä¼°é‡ > ${fN(v_strong)} å¼µ (1.5xâ†‘) ä¸” é–‹ç›¤åƒ¹ > ${fP(close)}
ğŸ‘‰ æŒ‡ä»¤ï¼š å¸‚åƒ¹è¿½ (Buy)ï¼Œå¼·å‹¢ç¼ºå£ä¸è£œï¼Œè¡Œæƒ…å™´å‡ºã€‚
ğŸŸ¢ åŠ‡æœ¬ B (å¹³ç›¤éœ‡ç›ª)
ğŸ”¹ é˜²å®ˆåƒ¹ï¼š${fP(breakoutLow)}
ğŸ”¹ æ¢ä»¶ï¼š é ä¼°é‡ ${fN(v_break)} å¼µå·¦å³ (ç´„ 1.3x)
ğŸ‘‰ æŒ‡ä»¤ï¼š ä½ˆå±€ (Buy)ï¼Œè¶ç›¤ä¸­æ‹‰å› 101~102 å»ºç«‹åŸºæœ¬éƒ¨ä½ã€‚
ğŸŸ¡ åŠ‡æœ¬ C (é‡ç¸®å›æ¸¬)
ğŸ”¹ é˜²å®ˆåƒ¹ï¼š${fP(breakoutLow)}
ğŸ”¹ æ¢ä»¶ï¼š é ä¼°é‡ < ${fN(v_wash)} å¼µ (0.8xâ†“)
ğŸ‘‰ æŒ‡ä»¤ï¼š è§€å¯Ÿ (Wait)ï¼Œè‹¥æ”¶ç›¤ä¸ç ´ ${fP(breakoutLow)}ï¼Œå°¾ç›¤å¯å°è²·ã€‚
âš« åŠ‡æœ¬ D (å‡çªç ´)
ğŸ”¹ é˜²å®ˆåƒ¹ï¼š${fP(breakoutLow)}
ğŸ”¹ æ¢ä»¶ï¼š æ”¶ç›¤è·Œç ´ ${fP(breakoutLow)} ä¸” çˆ†é‡æ”¶é»‘
ğŸ‘‰ æŒ‡ä»¤ï¼š åœæ (Stop Loss)ï¼Œç¢ºèªç‚ºå‡çªç ´é¨™ç·šã€‚
âš ï¸ å¯¦æˆ°ç°è‰²åœ°å¸¶è£œå¼· (SOP å¤–çš„æ‡‰è®Š)
é‡ä¸è¶³çš„å°·å°¬å€ï¼ˆåŠ‡æœ¬ B èˆ‡ C ä¹‹é–“ï¼‰ï¼š
ç‹€æ³ï¼š é ä¼°é‡è½åœ¨ ${fN(v_wash)} ~ ${fN(v_break)} å¼µã€‚
æ‡‰è®Šï¼š å‹•èƒ½æœªå®Œå…¨ç¢ºèªï¼Œåƒ…é™å°é‡ä½ˆå±€æˆ–è§€æœ›ï¼Œåš´ç¦è¿½åƒ¹ã€‚
é–‹ç›¤æ¼²å¹…çš„å°·å°¬å€ï¼š
ç‹€æ³ï¼š é–‹ç›¤æ¼²å¹…ç´„ 4%ï¼ˆ3%~5%ä¹‹é–“ï¼‰ï¼Œä¸”é ä¼°é‡ < ${fN(v_strong)} å¼µã€‚
æ‡‰è®Šï¼š ä¸è¦å¸‚åƒ¹è¿½ã€‚é«˜æ©Ÿç‡æœƒå›æ¸¬å‡åƒ¹ç·šï¼Œè«‹è€å¿ƒç­‰å¾…å›æª”å†æ¥ã€‚
ã€ä¸‰ã€ğŸ“Œ çªç ´æ“ä½œç­–ç•¥æ˜æ—¥å¯¦æˆ°ãƒ»é—œéµä¸‰å•ã€‘
â“ Q1ï¼šæ˜¨å¤©æ²’è²·åˆ°ï¼Œæ˜å¤©é–‹é«˜å¯ä»¥ç›´æ¥è¿½å—ï¼Ÿ
å»ºè­°ï¼š
é–‹ç›¤æ¼²å¹… â‰¤ 3% â†’ å¸‚åƒ¹ç›´æ¥è¿½è²·ã€‚
é–‹ç›¤æ¼²å¹… > 5% â†’ ç­‰ç›¤ä¸­å›æ¸¬å‡åƒ¹ç·šï¼ˆ101~102ï¼‰å†æ¥ã€‚
â“ Q2ï¼šæ€éº¼åˆ¤æ–·çªç ´æ˜¯çœŸçš„é‚„æ˜¯å‡ï¼Ÿ
åˆ¤æ–·æ¨™æº–ï¼š ä¸‰å¤©åŸå‰‡ + é ¸ç·šé˜²å®ˆ (é ¸ç·šåƒ¹ä½ï¼š${fP(breakoutLow)})
â“ Q3ï¼šè²·é€²å¾Œé–‹å§‹ç›¤è·Œæ€éº¼è¾¦ï¼Ÿ
é˜²å®ˆç­–ç•¥ï¼š åš´å®ˆ ${fP(breakoutLow)} å…ƒæ•´æ•¸é—œå¡
åœæé»ï¼š æ”¶ç›¤è·Œç ´ ${fP(breakoutLow)} â†’ ç„¡æ¢ä»¶åœæå‡ºå ´ã€‚
ç›¤ä¸­å›æ¸¬æƒ…æ³ï¼š ç›¤ä¸­å›æ¸¬å€é–“ (${fP(breakoutLow)}~102ï¼Œç´„çªç ´åƒ¹ Â±1%) â†’ è¦–ç‚ºå¥åº·å›æ¸¬ï¼Œæš«ä¸å‹•ä½œã€‚`;

                v16AIReport = `(ä¸€) ä¸»åŠ›å¿ƒç†é€è¦–ï¼š ä¸»åŠ›å‰›èŠ±éŒ¢åƒæ‰é ¸ç·šè³£å£“ï¼Œæˆæœ¬å°±åœ¨é€™é™„è¿‘ã€‚ç¾åœ¨é€²å ´æ˜¯ã€Œè·Ÿè‘—ä¸»åŠ›æˆæœ¬ä¸€èµ·è·‘ã€ã€‚
(äºŒ) æ•£æˆ¶å¿ƒç†é™·é˜±ï¼š çŒ¶è±«ä¸æ±ºï¼Œæƒ³ç­‰ã€Œæ‹‰å›å†è²·ã€ï¼Œçµæœè‚¡åƒ¹ä¸€å»ä¸å›é ­ã€‚
(ä¸‰) æ•™ç·´å¿ƒæ³•ï¼š ã€Œç¬¬ä¸€æ ¹çªç ´ä¸è²·ï¼Œå¾Œé¢ä½ å°±è²·ä¸ä¸‹æ‰‹äº†ã€‚å¯§å¯è²·éŒ¯åœæï¼Œä¸å¯éŒ¯éé£†è‚¡ã€‚ã€
(å››) çŸ³é ­æˆ°ç•¥çµè«–ï¼š
â— ç›¤å‹¢å®šèª¿ï¼š è¶¨å‹¢åè½‰ç¢ºèª (ç”±ç›¤æ•´è½‰å¤š)ã€‚
ğŸ¯ æ ¸å¿ƒç­–ç•¥ï¼š å¤§è†½å»ºç«‹éƒ¨ä½ï¼Œåš´æ ¼è¨­å®šåœæã€‚`;

             } else if (type === 'flat') {
                rTitleText = "ğŸ’¤ ç›¤æ•´å»¶çºŒ";
                rActionText = "è§€æœ› / ç©ºæ‰‹";
                rBoxClass = "bg-green-50 border-green-500";
                rTitleClass = "text-xl font-bold text-green-700";
                rActionClass = "text-2xl font-black text-green-800 border-b border-green-200 pb-2 mb-2";
                rIconText = "ğŸ¢";
                rTrendText = "ğŸ’¤ ç®±å‹éœ‡ç›ª (æ–¹å‘æœªæ˜)";
                rVolText = "é‡ç¸®æ•´ç† (äººæ°£é€€æ½®)";

                // Use high3d as box top, breakoutLow as box bottom if present, else fallback
                const boxTop = isNaN(high3d) ? close * 1.05 : high3d;
                const boxBottom = isNaN(breakoutLow) ? close * 0.95 : breakoutLow;

                v16BaseReport = `3. ã€æ¨¡æ“¬ç›¤æ•´ã€‘(è§€æœ›ç­‰å¾…)
âš ï¸ æ¨¡çµ„åˆ‡æ›åŸå‰‡ï¼š
ã€Œçªç ´ â†’ æ¥µå¼·ã€éœ€æ»¿è¶³é€£çºŒæ”»æ“Šé‡èˆ‡çµæ§‹ä¸ç ´
ã€Œæ¥µå¼· â†’ ç›¤æ•´ã€ä»¥é‡å¤§ä¸æ¼² / å‹•èƒ½éˆåŒ–ç‚ºåˆ¤æº–
ã€Œç›¤æ•´ â†’ å¤§è·Œã€ä»¥å¸¶é‡ç ´ç®±åº•ç‚ºç¢ºèª
ç¦æ­¢è·¨æ¨¡çµ„æ··ç”¨æŒ‡ä»¤
âš ï¸ æœ¬æ¨¡çµ„åƒ…åœ¨è‚¡åƒ¹è™•æ–¼ç®±å‹éœ‡ç›ªã€æ–¹å‘æœªæ˜ã€ä¸”æœªå¸¶é‡çªç ´é—œéµåƒ¹ä½æ™‚é©ç”¨
å—¨ï¼Œæˆ‘æ˜¯çŸ³é ­ï¼Œå¸Œæœ›æˆ‘çš„ N å­—æˆ°æ³•åˆ†æç³»çµ±èƒ½è®“ä½ å¤§å¹…æå‡å‹ç‡ğŸ“ˆğŸ’¯
N å­—æˆ°æ³•æŒ‡æ®ä¸­å¿ƒ by.çŸ³é ­ V16.1
ã€Œæœ¬ç­–ç•¥åƒ…ç‚ºå€‹äººåˆ†æåƒè€ƒï¼ŒæŠ•è³‡æœ‰é¢¨éšªï¼Œæ“ä½œéœ€è‡ªè² ç›ˆè™§ã€
è‚¡åï¼š${stockName}
ã€ä¸€ã€å€‹è‚¡ç¾æ³åˆ†æã€‘
ğŸ“Œ æ“ä½œæŒ‡ä»¤ï¼šã€ è§€æœ› / ç©ºæ‰‹ ã€‘
(è«‹ç¢ºèªæ¨¡çµ„ç‹€æ…‹ç¬¦åˆæ¢ä»¶å†æ“ä½œ)
âš¡ é‡èƒ½ç‹€æ…‹ï¼š é‡ç¸®æ•´ç† (äººæ°£é€€æ½®)
ğŸ’° ç•¶å‰ç¾åƒ¹ï¼š ${fP(close)}
ğŸ“¦ ç®±é«”å€é–“ï¼š ${fP(boxBottom)} (åº•) ~ ${fP(boxTop)} (é ‚)
ğŸ“ˆ ç›¤å‹¢å‹æ…‹ï¼š ğŸ’¤ ç®±å‹éœ‡ç›ª (æ–¹å‘æœªæ˜)
âœ… è§€å¯Ÿé‡é»ï¼š èƒ½å¦å¸¶é‡çªç ´ ${fP(boxTop)}
âš ï¸ é˜²å®ˆè¦é»ï¼š ç®±åº•æ”¯æ’ ${fP(boxBottom)} ä¸å¯ç ´
â˜… é‡åƒ¹æ¨æ¼” (å‡é‡æŒ‡éå» 5 æ—¥å¹³å‡æˆäº¤é‡ ${fN(avgVol)})ï¼š
ğŸ”¥ æ”»æ“Šé–€æª» (1.3x)ï¼š${fN(v_break)} (æœªé”æ¨™)
ğŸš¿ æ´—ç›¤é–€æª» (0.8x)ï¼š${fN(v_wash)} (é”æ¨™)
ğŸ“Œ å°çµï¼š âœ… æœ¬æª”ã€Œ${stockName}ã€ç›®å‰è™•æ–¼ç›¤æ•´ç­‰å¾…æœŸï¼Œä¸»åŠ›æ­£åœ¨ç£¨è€å¿ƒã€‚
ğŸ¯ å‹•æ…‹æ¸¬å¹…åŸºæº–
æš«ç„¡ç›®æ¨™åƒ¹ï¼Œå› è¶¨å‹¢æœªç™¼å‹•ã€‚
ç•¶å‰ä»»å‹™ï¼šç›¯ç·Š 09:15 é ä¼°é‡ã€‚
ã€äºŒã€æ˜æ—¥é–‹ç›¤ãƒ»é‡èƒ½ä½œæˆ°åŠ‡æœ¬ã€‘
ğŸ’¡ æˆ°è¡“å°å¡ï¼š é ä¼°é‡ = 09:15 æˆäº¤é‡ Ã— 8
ğŸ”´ åŠ‡æœ¬ A (é»ç«æ”»æ“Š)
ğŸ”¹ é˜²å®ˆåƒ¹ï¼š${fP(boxBottom)}
ğŸ”¹ æ¢ä»¶ï¼š é ä¼°é‡ > ${fN(v_break)} å¼µ (1.3xâ†‘) ä¸” åƒ¹æ ¼çªç ´ ${fP(boxTop)}
ğŸ‘‰ æŒ‡ä»¤ï¼š é€²å ´ (Buy)ï¼Œç›¤æ•´çµæŸï¼Œå¤šé ­ç™¼èµ·é€²æ”»ã€‚
ğŸŸ¢ åŠ‡æœ¬ B (æŒçºŒç›¤æ•´)
ğŸ”¹ é˜²å®ˆåƒ¹ï¼š${fP(boxBottom)}
ğŸ”¹ æ¢ä»¶ï¼š é ä¼°é‡ ${fN(v_wash)} ~ ${fN(avgVol)} å¼µ (0.8x ~ 1.0x)ï¼Œåƒ¹æ ¼åœ¨ ${fP(boxBottom)}-${fP(boxTop)} é–“
ğŸ‘‰ æŒ‡ä»¤ï¼š ç¡è¦º (Sleep)ï¼Œä¸è¦æµªè²»è³‡é‡‘èˆ‡æ™‚é–“ã€‚
ğŸŸ¡ åŠ‡æœ¬ C (æ¥µè‡´é‡ç¸®)
ğŸ”¹ é˜²å®ˆåƒ¹ï¼š${fP(boxBottom)}
ğŸ”¹ æ¢ä»¶ï¼š é ä¼°é‡ < ${fN(Math.round(avgVol * 0.5))} å¼µ (0.5xâ†“)
âš ï¸ è¨»ï¼šç›¤æ•´ç›¤é‡ç¸®æ¨™æº–ç‚º <0.5xï¼Œèˆ‡æ¥µå¼·ç›¤ä¸åŒã€‚
ğŸ‘‰ æŒ‡ä»¤ï¼š é—œæ³¨ (Watch)ï¼Œè®Šç›¤å‰å…†ã€‚è‹¥ç›¤ä¸­é‡èƒ½æš´å¢ï¼Œå³è½‰ã€æ¨¡æ“¬çªç ´ã€‘åŠ‡æœ¬ã€‚
âš« åŠ‡æœ¬ D (ç ´åº•å±æ©Ÿ)
ğŸ”¹ é˜²å®ˆåƒ¹ï¼š${fP(boxBottom)}
ğŸ”¹ æ¢ä»¶ï¼š è·Œç ´ ${fP(boxBottom)}
ğŸ‘‰ æŒ‡ä»¤ï¼š åˆªè‡ªé¸ (Delete)ã€‚
âš ï¸ ç‰¹åˆ¥èªªæ˜ï¼šå¸¶é‡ç ´åº• (>${fN(Math.round(avgVol * 1.2))} å¼µ) ç‚ºçµ•å°å‡ºå ´é»ï¼›è‹¥ç„¡é‡è·Œç ´ç®±åº• (<${fN(Math.round(avgVol * 1.2))} å¼µ)ï¼Œé›–æš«ä¸ä¸€å®šç«‹å³åœæï¼Œä½†è¦–ç‚ºè¶¨å‹¢è½‰å¼±è­¦è¨Šï¼Œéœ€æ¸›æŒè§€æœ›ã€‚
âš ï¸ å¯¦æˆ°ç°è‰²åœ°å¸¶è£œå¼· (SOP å¤–çš„æ‡‰è®Š)
ç®±é ‚é™„è¿‘çš„ç°è‰²èª˜æƒ‘ï¼š
ç‹€æ³ï¼š åƒ¹æ ¼ä¾†åˆ° ${fP(boxTop)}é™„è¿‘ï¼Œä½†é‡èƒ½åªæœ‰ 800~1,000 å¼µï¼ˆæœªé”æ”»æ“Šé‡ï¼‰ã€‚
æ‡‰è®Šï¼š ä¸è¦å·è·‘ã€‚å¿…é ˆåš´æ ¼éµå®ˆã€Œé‡çªç ´ ${fN(v_break)} ä¸” åƒ¹æ ¼ç¢ºèªç«™ä¸Š ${fP(boxTop)}ã€æ‰èƒ½é€²å ´ã€‚
ã€ä¸‰ã€ğŸ“Œç›¤æ•´æ“ä½œç­–ç•¥å°ˆå±¬æ˜æ—¥å¯¦æˆ°ãƒ»é—œéµä¸‰å•ã€‘
â“ Q1ï¼šç¾åœ¨åƒ¹æ ¼å¥½ä¾¿å®œï¼Œæˆ‘èƒ½ä¸èƒ½å…ˆè²·èµ·ä¾†æ”¾ï¼Ÿ
å»ºè­°ï¼š âŒ ä¸å»ºè­°ç¾åœ¨è²·ï¼è³‡é‡‘æœ‰æ©Ÿæœƒæˆæœ¬ã€‚
â“ Q2ï¼šè¦çœ‹åˆ°ä»€éº¼è¨Šè™Ÿï¼Œæ‰ä»£è¡¨ç›¤æ•´çµæŸï¼Ÿ
ğŸ”¥ é»ç«è¨Šè™Ÿï¼š ç¬¬ä¸€æ ¹å¸¶é‡ç´… K æ£’ã€‚
åˆ¤æ–·æ¢ä»¶ï¼š æˆäº¤é‡ â‰¥ ${fN(Math.round(avgVol * 1.5))} ä¸” æ”¶ç›¤åƒ¹å¼·å‹¢ç«™ä¸Šç®±é ‚ ${fP(boxTop)} å…ƒã€‚
â“ Q3ï¼šæˆäº¤é‡è¶Šä¾†è¶Šå°‘ï¼Œæ˜¯ä¸æ˜¯æ²’äººç©äº†ï¼Ÿ
ğŸ’¡ è§£è®€ï¼š é‡ç¸®å…¶å¯¦æ˜¯å¥½äº‹ï¼Œä»£è¡¨ç±Œç¢¼æ²‰æ¾±ã€‚ã€Œæ¥µè‡´é‡ç¸®ã€å¾€å¾€æ˜¯è®Šç›¤çš„å‰å…†ã€‚`;

                v16AIReport = `(ä¸€) ä¸»åŠ›å¿ƒç†é€è¦–ï¼š ä¸»åŠ›æ­£åœ¨å¸ç´ç±Œç¢¼ï¼Œé€éé•·æ™‚é–“çš„ç£¨ç›¤ï¼Œè®“æ²’è€å¿ƒçš„æ•£æˆ¶é›¢å ´ã€‚
(äºŒ) æ•£æˆ¶å¿ƒç†é™·é˜±ï¼š è€ä¸ä½å¯‚å¯éš¨æ„é€²å ´ï¼Œçµæœè¢«é›™å·´ï¼ˆè¿½é«˜æ®ºä½ï¼‰ã€‚
(ä¸‰) æ•™ç·´å¿ƒæ³•ï¼š ã€Œçµäººæœ€é‡è¦ä¸æ˜¯æ§æ³•ï¼Œæ˜¯ç­‰å¾…çµç‰©å‡ºç¾çš„è€å¿ƒã€‚çœ‹ä¸æ‡‚å°±ä¼‘æ¯ï¼Œç¾é‡‘ç‚ºç‹ã€‚ã€
(å››) çŸ³é ­æˆ°ç•¥çµè«–ï¼š
â— ç›¤å‹¢å®šèª¿ï¼š ç±Œç¢¼æ²‰æ¾±æœŸã€‚
ğŸ¯ æ ¸å¿ƒç­–ç•¥ï¼š è¨­å¥½ã€Œåƒ¹æ ¼è­¦ç¤ºã€(${fP(boxTop)}å…ƒ)ï¼ŒéŸ¿äº†å†ä¾†çœ‹ã€‚`;

             } else if (type === 'crash') {
                rTitleText = "âš ï¸ ä¸‰ç›¤è·Œç ´";
                rActionText = "åœæ / åæ‰‹æ”¾ç©º";
                rBoxClass = "bg-green-100 border-green-600";
                rTitleClass = "text-xl font-bold text-green-900";
                rActionClass = "text-2xl font-black text-green-900 underline border-b border-green-300 pb-2 mb-2";
                rIconText = "ğŸ“‰";
                rTrendText = "ğŸ“‰ é ­éƒ¨å®Œæˆ (ç©ºæ–¹è¶¨å‹¢)";
                rVolText = "å¸¶é‡ä¸‹æ®º (ä¸»åŠ›å‡ºè²¨)";

                const drop20 = (close * 0.8).toFixed(2);
                // In simulation inputs, breakoutLow is used as pressure
                const pressure = isNaN(breakoutLow) ? close * 1.05 : breakoutLow;
                // Use todayHigh as h2 in crash simulation logic if available
                const crash_h2 = todayH;
                const down_target = L - (todayH - L); // Basic measured move

                v16BaseReport = `4. ã€æ¨¡æ“¬å¤§è·Œã€‘(ç©ºæ–¹å´©ç›¤)
âš ï¸ æ¨¡çµ„åˆ‡æ›åŸå‰‡ï¼š
ã€Œçªç ´ â†’ æ¥µå¼·ã€éœ€æ»¿è¶³é€£çºŒæ”»æ“Šé‡èˆ‡çµæ§‹ä¸ç ´
ã€Œæ¥µå¼· â†’ ç›¤æ•´ã€ä»¥é‡å¤§ä¸æ¼² / å‹•èƒ½éˆåŒ–ç‚ºåˆ¤æº–
ã€Œç›¤æ•´ â†’ å¤§è·Œã€ä»¥å¸¶é‡ç ´ç®±åº•ç‚ºç¢ºèª
ç¦æ­¢è·¨æ¨¡çµ„æ··ç”¨æŒ‡ä»¤
âš ï¸ æœ¬æ¨¡çµ„åƒ…åœ¨è‚¡åƒ¹çµæ§‹å·²å£ã€ç©ºæ–¹è¶¨å‹¢ç¢ºèªã€ä¸”ä¸»åŠ›å‡ºè²¨å¸¶é‡ä¸‹æ®ºæ™‚é©ç”¨
å—¨ï¼Œæˆ‘æ˜¯çŸ³é ­ï¼Œå¸Œæœ›æˆ‘çš„ N å­—æˆ°æ³•åˆ†æç³»çµ±èƒ½è®“ä½ å¤§å¹…æå‡å‹ç‡ğŸ“ˆğŸ’¯
N å­—æˆ°æ³•æŒ‡æ®ä¸­å¿ƒ by.çŸ³é ­ V16.1
ã€Œæœ¬ç­–ç•¥åƒ…ç‚ºå€‹äººåˆ†æåƒè€ƒï¼ŒæŠ•è³‡æœ‰é¢¨éšªï¼Œæ“ä½œéœ€è‡ªè² ç›ˆè™§ã€
è‚¡åï¼š${stockName}
ã€ä¸€ã€å€‹è‚¡ç¾æ³åˆ†æã€‘
ğŸ“Œ æ“ä½œæŒ‡ä»¤ï¼šã€ åœæ / åæ‰‹æ”¾ç©º ã€‘
(è«‹ç¢ºèªæ¨¡çµ„ç‹€æ…‹ç¬¦åˆæ¢ä»¶å†æ“ä½œ)
âš¡ é‡èƒ½ç‹€æ…‹ï¼š å¸¶é‡ä¸‹æ®º (ä¸»åŠ›å‡ºè²¨)
ğŸ’° ç•¶å‰ç¾åƒ¹ï¼š ${fP(close)}
ğŸ“‰ 20% è·Œå¹…ï¼š è·Œåˆ°${drop20}$ (ç„¡åº•æ·±æ·µ)
ğŸ“ˆ ç›¤å‹¢å‹æ…‹ï¼š ğŸ“‰ é ­éƒ¨å®Œæˆ (ç©ºæ–¹è¶¨å‹¢)
âœ… ä¸‹æª”æ”¯æ’ï¼š æ·±ä¸å¯æ¸¬ (å‹¿çŒœåº•)
âš ï¸ å£“åŠ›é—œå¡ï¼š ${fP(pressure)} (åŸæ”¯æ’è®Šå£“åŠ›)
â˜… é‡åƒ¹æ¨æ¼” (å‡é‡æŒ‡éå» 5 æ—¥å¹³å‡æˆäº¤é‡ ${fN(avgVol)})ï¼š
ğŸ”¥ ä¸‹æ®ºæ”»æ“Šé‡ (1.3x)ï¼š${fN(v_break)}ï¼ˆé”æ¨™ï¼‰âœ…
ğŸ“Œ å°çµï¼š æœ¬æª”ã€Œ${stockName}ã€çµæ§‹å·²å£ï¼Œä»»ä½•åå½ˆçš†æ˜¯ç©ºé»ã€‚
ğŸ¯ å‹•æ…‹æ¸¬å¹…åŸºæº– (h2=${fP(crash_h2)}ï¼Œå…¬å¼ï¼šç›®æ¨™åƒ¹ = h2 - N Ã— (é ­éƒ¨ - h2))
åå£“ç›®æ¨™ï¼š ${fP(pressure)} (é€ƒå‘½é»)
ä¸‹æ®ºæ¸¬å¹…ï¼š ${fP(down_target)} (ç¬¬ä¸€éšæ®µæ»¿è¶³é»)
ã€äºŒã€æ˜æ—¥é–‹ç›¤ãƒ»é‡èƒ½ä½œæˆ°åŠ‡æœ¬ã€‘
ğŸ’¡ æˆ°è¡“å°å¡ï¼š é ä¼°é‡ = 09:15 æˆäº¤é‡ Ã— 8
ğŸ”´ åŠ‡æœ¬ A (è·³ç©ºå¤§è·Œ)
ğŸ”¹ é˜²å®ˆå£“åŠ›ï¼š${fP(pressure)}
ğŸ”¹ æ¢ä»¶ï¼š é ä¼°é‡ > ${fN(v_strong)} å¼µ (1.5xâ†‘) ä¸” é–‹ä½ã€‚
ğŸ‘‰ æŒ‡ä»¤ï¼š è‹¥å¸¶é‡ç¢ºèªè·Œç ´å‰ä½ï¼Œå¯è¿½ç©º (Short)ï¼Œåš´é˜²ç„¡é‡ç©ºæ®ºã€‚
ğŸŸ¢ åŠ‡æœ¬ B (å¼±å‹¢åå½ˆ)
ğŸ”¹ é˜²å®ˆå£“åŠ›ï¼š${fP(pressure)}
ğŸ”¹ æ¢ä»¶ï¼š é‡ç¸® (${fN(v_wash)}å¼µï¼Œç´„ 0.8x) ç´…ç›¤ã€‚
ğŸ‘‰ æŒ‡ä»¤ï¼š é€ƒå‘½ (Exit)ï¼Œä¿ç•™è³‡é‡‘ç­‰å¾…ä¸‹ä¸€æ³¢ä¸‹è·Œã€‚
ğŸŸ¡ åŠ‡æœ¬ C (é‡ç¸®ç·©è·Œ)
ğŸ”¹ é˜²å®ˆå£“åŠ›ï¼š${fP(pressure)}
ğŸ”¹ æ¢ä»¶ï¼š é ä¼°é‡ < ${fN(v_wash)} å¼µ (0.8xâ†“)ã€‚
ğŸ‘‰ æŒ‡ä»¤ï¼š ç©ºå–®çºŒæŠ± (Hold Short)ã€‚
âš« åŠ‡æœ¬ D (Vå‹åè½‰)
ğŸ”¹ é˜²å®ˆå£“åŠ›ï¼š${fP(pressure)}
ğŸ”¹ æ¢ä»¶ï¼š æ”¶ç›¤ç«™å› ${fP(pressure)}ã€é‡èƒ½é” ${fN(v_break)} (1.3xâ†‘) ä¸” é€£çºŒå…©æ—¥é‡å¢
ğŸ‘‰ æŒ‡ä»¤ï¼š å›è£œç©ºå–® (Cover)ï¼Œå¯èƒ½ç‚ºå‡è·Œç ´ï¼Œå…ˆé€€å ´è§€æœ›ã€‚
âš ï¸ å¯¦æˆ°ç°è‰²åœ°å¸¶è£œå¼· (SOP å¤–çš„æ‡‰è®Š)
åå½ˆå£“åŠ›å€ï¼š
ç‹€æ³ï¼š è‚¡åƒ¹åå½ˆè‡³ ${fP(pressure)} é™„è¿‘ï¼Œä¸”çˆ†å‡ºå¤§é‡ï¼Œä½†æ”¶ç›¤å‰›å¥½å¡åœ¨ ${fP(pressure)} æˆ–å¾®å¹…è·Œç ´ã€‚
æ‡‰è®Šï¼š å»ºè­°å…ˆå›è£œ 1/3 ç©ºå–®é–ä½åˆ©æ½¤ï¼Œå‰©ä¸‹çš„è§€å¯Ÿæ˜æ—¥æ˜¯å¦ç«™ç©© ${fP(pressure)}ã€‚
ã€ä¸‰ã€ğŸ“Œ å¤§è·Œç›¤æ“ä½œç­–ç•¥å°ˆå±¬æ˜æ—¥å¯¦æˆ°ãƒ»é—œéµä¸‰å•ã€‘
â“ Q1ï¼šå·²ç¶“è·Œäº†ï¼Œèƒ½ä¸èƒ½é€²å ´æ”¤å¹³ï¼Ÿ
ç•¶å‰åƒ¹ï¼š ${fP(close)}
20% è·Œå¹…å°ç…§ï¼š (å¾ ${fP(close)} ç®—èµ· 20% ç‚º ${drop20} å…ƒ)
âŒ è­¦å‘Šï¼š é€™æ˜¯è‡ªæ®ºè¡Œç‚ºï¼ä¸è¦æ¥åˆ€å­ã€‚
â“ Q2ï¼šæˆ‘æƒ³æ”¾ç©ºï¼Œå“ªè£¡æ˜¯æœ€å¥½çš„ç©ºé»ï¼Ÿ
åå½ˆå£“åŠ›å€ï¼š ${fP(pressure*0.98)}~${fP(pressure)}
ğŸ“ˆ å»ºè­°æ“ä½œï¼š ç­‰å¾…è‚¡åƒ¹åå½ˆè‡³å£“åŠ›å€å»æ¼²ä¸å‹•ï¼Œå‡ºç¾ä¸Šå½±ç·šæ™‚ç‚ºå‹ç‡æœ€é«˜çš„ç©ºé»ã€‚
â“ Q3ï¼šå¦‚æœæ˜å¤©é–‹ç´…ç›¤ï¼Œæ˜¯ä¸æ˜¯ä»£è¡¨æ­¢è·Œäº†ï¼Ÿ
âŒ è¿·æ€ï¼š ç´…ç›¤ â‰  æ­¢è·Œã€‚
é—œéµåˆ¤æ–·ï¼š è‹¥è‚¡åƒ¹ä» < ${fP(pressure)} â†’ åªæ˜¯æ­»è²“è·³ï¼Œç©ºé ­è¶¨å‹¢æœªæ”¹ã€‚`;

                v16AIReport = `(ä¸€) ä¸»åŠ›å¿ƒç†é€è¦–ï¼š ä¸»åŠ›æ—©å·²åœ¨é«˜æª”å‡ºè²¨å®Œç•¢ï¼Œç¾åœ¨æ˜¯è®“æ•£æˆ¶äº’ç›¸è¸©è¸ã€‚
(äºŒ) æ•£æˆ¶å¿ƒç†é™·é˜±ï¼š ä¸ç”˜å¿ƒè™§æï¼Œæ‚£å¾—æ‚£å¤±ã€‚
(ä¸‰) æ•™ç·´å¿ƒæ³•ï¼š ã€Œç•™å¾—é’å±±åœ¨ï¼Œä¸æ€•æ²’æŸ´ç‡’ã€‚æˆªæ–·è™§æï¼Œè®“åˆ©æ½¤å¥”è·‘ã€‚ã€
(å››) çŸ³é ­æˆ°ç•¥çµè«–ï¼š
â— ç›¤å‹¢å®šèª¿ï¼š ç©ºæ–¹ä¸»è·Œæ®µã€‚
ğŸ¯ æ ¸å¿ƒç­–ç•¥ï¼š åªå‡ºä¸é€²ï¼Œç”šè‡³åæ‰‹åšç©ºã€‚åš´ç¦æŠ„åº•ã€‚`;
             }

             // Update UI
             resultBox.className = `p-5 rounded-xl border-l-8 shadow-md relative overflow-hidden ${rBoxClass}`;
             document.getElementById('stockBadge').innerText = stockName;
             document.getElementById('resultTitle').innerText = rTitleText;
             document.getElementById('resultTitle').className = rTitleClass;
             document.getElementById('resultAction').innerText = rActionText;
             document.getElementById('resultAction').className = rActionClass;
             document.getElementById('resultIcon').innerText = rIconText;
             document.getElementById('trendTag').innerText = rTrendText;
             document.getElementById('trendTag').className = "text-xs font-bold px-2 py-1 rounded bg-slate-100 text-slate-700 border border-slate-200"; 
             document.getElementById('volTag').innerText = rVolText;
             document.getElementById('volTag').className = "text-xs font-bold px-2 py-1 rounded bg-slate-100 text-slate-700 border border-slate-200";
             document.getElementById('patternTag').classList.add('hidden'); // Hide for custom V16 sim
             document.getElementById('inferenceBox').classList.add('hidden'); // Content already in V16 text
             document.getElementById('resultAdvice').innerText = "è«‹åƒé–±ä¸‹æ–¹å®Œæ•´ V16.1 æˆ°ç•¥å ±å‘Šã€‚";
             
             // Hide specific calc parts as they are in text
             document.getElementById('targetBox').classList.add('hidden');

             // Render AI Part
             document.getElementById('aiAnalysisBox').classList.remove('hidden');
             document.getElementById('aiLoading').classList.add('hidden');
             document.getElementById('aiReportTitle').innerText = `ğŸ§  çŸ³é ­æˆ°ç•¥(${stockName}) V16.1 åˆ†æå ±å‘Š`;
             
             // Parse Markdown for AI Report
             const htmlContent = marked.parse(v16AIReport);
             document.getElementById('aiContent').innerHTML = htmlContent;

             // Set Base Report Text for Copy
             baseReportText = v16BaseReport;
             aiReportContent = v16AIReport; // For appending later
        }
