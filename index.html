<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Nå­—æˆ°æ³•ï¼šä¸‰ç›¤è½‰æŠ˜åˆ¤æ–·è¨ˆç®—æ©Ÿ (V13.7 é‚è¼¯ä¿®æ­£ç‰ˆ)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700;900&display=swap');
        body { font-family: 'Noto Sans TC', sans-serif; -webkit-tap-highlight-color: transparent; }
        .fade-in { animation: fadeIn 0.4s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }
        
        /* å·è»¸ç¾åŒ– */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }
        
        .invalid-target { text-decoration: line-through; color: #9ca3af; }
        .input-error { border-color: #ef4444 !important; ring: 2px; ring-color: #ef4444; background-color: #fef2f2; }
        
        /* é–ƒçˆæé†’ç‰¹æ•ˆ */
        @keyframes highlightPulse {
            0% { background-color: #fff; }
            50% { background-color: #fef9c3; } /* yellow-100 */
            100% { background-color: #fff; }
        }
        .highlight-input { animation: highlightPulse 1s ease-in-out; }

        /* æ‘ºç–Šé¸å–®æ¨£å¼ */
        details > summary { list-style: none; cursor: pointer; transition: all 0.2s; }
        details > summary::-webkit-details-marker { display: none; }
        details[open] > summary { margin-bottom: 0.5rem; }
        details > summary:hover { background-color: #f8fafc; }

        /* AI Loading Animation */
        .dot-flashing {
            position: relative;
            width: 6px;
            height: 6px;
            border-radius: 5px;
            background-color: #6366f1;
            color: #6366f1;
            animation: dot-flashing 1s infinite linear alternate;
            animation-delay: 0.5s;
        }
        .dot-flashing::before, .dot-flashing::after {
            content: "";
            display: inline-block;
            position: absolute;
            top: 0;
        }
        .dot-flashing::before {
            left: -10px;
            width: 6px;
            height: 6px;
            border-radius: 5px;
            background-color: #6366f1;
            color: #6366f1;
            animation: dot-flashing 1s infinite alternate;
            animation-delay: 0s;
        }
        .dot-flashing::after {
            left: 10px;
            width: 6px;
            height: 6px;
            border-radius: 5px;
            background-color: #6366f1;
            color: #6366f1;
            animation: dot-flashing 1s infinite alternate;
            animation-delay: 1s;
        }
        @keyframes dot-flashing {
            0% { background-color: #6366f1; }
            50%, 100% { background-color: #e0e7ff; }
        }
        
        /* Markdown Styles for AI Response */
        .ai-content h1, .ai-content h2, .ai-content h3 { font-weight: 800; margin-top: 0.5em; margin-bottom: 0.3em; color: #1e1b4b; }
        .ai-content ul { list-style-type: disc; padding-left: 1.2em; margin-bottom: 0.5em; }
        .ai-content p { margin-bottom: 0.5em; line-height: 1.6; }
        .ai-content strong { color: #b91c1c; }
    </style>
</head>
<body class="bg-slate-100 min-h-screen flex items-center justify-center p-4">

    <div class="bg-white rounded-2xl shadow-2xl w-full max-w-xl overflow-hidden border border-slate-300 relative">
        <!-- Header -->
        <div class="bg-slate-900 p-5 text-white text-center relative z-20">
            <h1 class="text-2xl font-black tracking-wider">Nå­—æˆ°æ³•æŒ‡æ®ä¸­å¿ƒ by.çŸ³é ­ <span class="text-yellow-400 text-sm align-top">V13.7</span></h1>
            <p class="text-xs text-slate-400 mt-1">é‡èƒ½åŠ‡æœ¬ x ç›¤æ…‹åˆ¤è®€ x å¯¦æˆ°ä¸‰å•</p>
        </div>

        <!-- æˆ°æ³•ç™¾ç§‘å…¨æ›¸ (Accordion Menu) -->
        <div class="bg-slate-50 border-b border-slate-200">
            <div class="p-3 text-center bg-blue-700 text-white font-bold text-sm cursor-pointer hover:bg-blue-800 transition-colors" onclick="toggleEncyclopedia()">
                ğŸ“– é»æˆ‘æ‰“é–‹ï¼šNå­—æˆ°æ³•å…¨èƒ½ç™¾ç§‘ (åœ–è§£ç²¾è¯) â–¼
            </div>
            
            <div id="encyclopediaContent" class="hidden max-h-[500px] overflow-y-auto p-4 space-y-3 shadow-inner bg-white">
                <!-- Part 1: åŸºç¤è¶¨å‹¢ -->
                <div class="text-xs font-black text-slate-400 uppercase tracking-widest mt-2 mb-1">ç¬¬ä¸€ç¯‡ï¼šåŸºç¤è¶¨å‹¢èˆ‡è½‰æŠ˜ (å®šå¤šç©º)</div>
                <details class="group border border-indigo-200 rounded overflow-hidden">
                    <summary class="flex justify-between items-center font-bold text-indigo-800 bg-indigo-50 p-3">
                        <span>1. è¶¨å‹¢ç¯‡ï¼šæœ«å‡ä½ & æœ«è·Œé«˜</span>
                        <span class="text-indigo-500 transition-transform group-open:rotate-180">â–¼</span>
                    </summary>
                    <div class="p-3 text-xs text-slate-700 bg-white space-y-2">
                        <p><span class="font-bold text-red-600">â— æœ«å‡ä½ (Last Rising Low)ï¼š</span>å¤šé ­å‰µé«˜æ³¢æ®µçš„ã€Œèµ·æ¼²é»ã€ã€‚<br>é‚è¼¯ï¼šå®ˆä½æœ«å‡ä½=å¤šé ­ï¼Œè·Œç ´=è¶¨å‹¢ç ´å£ã€‚</p>
                        <p><span class="font-bold text-green-600">â— æœ«è·Œé«˜ (Last Falling High)ï¼š</span>ç©ºé ­å‰µä½æ³¢æ®µçš„ã€Œèµ·è·Œé»ã€ã€‚<br>é‚è¼¯ï¼šçªç ´æœ«è·Œé«˜=ç©ºç¿»å¤šã€‚</p>
                    </div>
                </details>

                <details class="group border border-indigo-200 rounded overflow-hidden">
                    <summary class="flex justify-between items-center font-bold text-indigo-800 bg-indigo-50 p-3">
                        <span>2. è½‰æŠ˜è¨Šè™Ÿï¼šæ—¥å‡ºç·š & æ—¥è½ç·š</span>
                        <span class="text-indigo-500 transition-transform group-open:rotate-180">â–¼</span>
                    </summary>
                    <div class="p-3 text-xs text-slate-700 bg-white space-y-2">
                        <p><span class="font-bold text-red-600">ğŸŒ… æ—¥å‡ºç·š (Sunrise)ï¼š</span>é«˜éæ˜¨é«˜ï¼Œæ”¶ç›¤æ”¶é«˜ã€‚<br>ç”¨é€”ï¼šå›æª”æ™‚çš„æ­¢è·Œè²·è¨Šã€‚</p>
                        <p><span class="font-bold text-green-600">ğŸŒ‡ æ—¥è½ç·š (Sunset)ï¼š</span>ä½ç ´æ˜¨ä½ï¼Œæ”¶ç›¤æ”¶ä½ã€‚<br>ç”¨é€”ï¼šä¸Šæ¼²æ™‚çš„æ­¢æ¼²è³£è¨Šã€‚</p>
                        <p class="bg-indigo-50 p-1 rounded font-bold text-center">å£è¨£ï¼šå›æª”æ‰¾æ—¥å‡ºï¼Œä¸Šæ¼²é˜²æ—¥è½ã€‚</p>
                    </div>
                </details>

                <details class="group border border-purple-200 rounded overflow-hidden">
                    <summary class="flex justify-between items-center font-bold text-purple-800 bg-purple-50 p-3">
                        <span>3. é˜²å®ˆç¯‡ï¼šè»‹ç©ºä½ & ç¿»ç´…å®šç¾©</span>
                        <span class="text-purple-500 transition-transform group-open:rotate-180">â–¼</span>
                    </summary>
                    <div class="p-3 text-xs text-slate-700 bg-white space-y-3">
                        <p><span class="font-bold bg-indigo-100 text-indigo-800 px-1 rounded">ç¿»ç´…Kæ£’ï¼š</span> å¯¶å¡”ç·šç”±ç¶ ç¿»ç´… (æ”¶ç›¤ > å‰ä¸‰é«˜) ç•¶å¤©çš„é‚£æ ¹Kæ£’ã€‚</p>
                        <p><span class="font-bold bg-purple-100 text-purple-800 px-1 rounded">è»‹ç©ºä½ï¼š</span> ç¿»ç´…Kæ£’çš„<span class="text-red-600 font-bold">æœ€ä½é»</span>ã€‚</p>
                        
                        <!-- æˆæœ¬è¿·æ€è§£æƒ‘ -->
                        <div class="bg-red-50 p-2 rounded border border-red-200">
                            <p class="font-bold text-red-800 border-b border-red-200 pb-1 mb-1">ğŸ’¡ è»‹ç©ºä½å¡«å“ªä¸€å¤©ï¼Ÿ</p>
                            <p class="mb-1 text-slate-800 font-bold">Nå­—æˆ°æ³•æ“ä½œã€Œç•¶ä¸‹ã€ï¼Œä¸å•æˆæœ¬ï¼</p>
                            <div class="grid grid-cols-1 gap-2 mt-2">
                                <div class="bg-yellow-50 p-2 rounded border border-yellow-200">
                                    <p class="font-bold text-yellow-800">ğŸ“Œ æƒ…å¢ƒ A (ç©ºæ‰‹æƒ³è²·)</p>
                                    <p>è¼¸å…¥ï¼šå¡« <span class="font-bold text-red-600">ã€Œä»Šå¤©ã€</span> çš„ç›¤ä¸­æœ€ä½é»ã€‚</p>
                                </div>
                                <div class="bg-green-50 p-2 rounded border border-green-200">
                                    <p class="font-bold text-green-800">ğŸ“Œ æƒ…å¢ƒ B (æŒæœ‰çºŒæŠ±)</p>
                                    <p>è¼¸å…¥ï¼šå¡« <span class="font-bold text-red-600">ã€Œç•¶åˆè²·é€²é‚£å¤©ã€</span> çš„æœ€ä½é»ã€‚</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </details>

                 <!-- NEW: å¯¶å¡”ç·šé‚è¼¯ -->
                <div class="text-xs font-black text-slate-400 uppercase tracking-widest mt-4 mb-1">ç¬¬äºŒç¯‡ï¼šå¯¶å¡”ç·šèˆ‡ç›¤æ…‹åœ–è§£ (é‡é»)</div>

                <details class="group border border-blue-200 rounded overflow-hidden">
                    <summary class="flex justify-between items-center font-bold text-blue-800 bg-blue-50 p-3">
                        <span>4. åŸç†ç¯‡ï¼šå¯¶å¡”ç·š (TOW) é‚è¼¯è©³è§£</span>
                        <span class="text-blue-500 transition-transform group-open:rotate-180">â–¼</span>
                    </summary>
                    <div class="p-3 text-xs text-slate-700 bg-white space-y-3">
                         <div class="bg-yellow-50 p-2 rounded border border-yellow-200">
                            <p class="font-bold text-yellow-900 border-b border-yellow-200 pb-1 mb-1">ğŸ’¡ ç‚ºä»€éº¼è§€å¯Ÿä¸‰å¤©ï¼Ÿ (åƒæ•¸=3)</p>
                            <ul class="list-decimal list-inside space-y-1 text-yellow-800">
                                <li><span class="font-bold">éæ¿¾å‡è¨Šè™Ÿï¼š</span>é¿å…ã€Œä¸€æ—¥è¡Œæƒ…ã€ã€‚</li>
                                <li><span class="font-bold">å¿ƒç†é˜²ç·šï¼š</span>Day 1 è®Šç›¤ï¼ŒDay 2 å»¶çºŒï¼ŒDay 3 ç¢ºç«‹ã€‚</li>
                                <li><span class="font-bold">æ“ä½œç²¾é«“ï¼š</span>ç¶ ç¿»ç´…å¾Œï¼Œè‹¥é€£çºŒä¸‰å¤©ä¸ç ´ Day 1 ä½é»ï¼Œå¤šé ­ç¢ºç«‹ã€‚</li>
                            </ul>
                        </div>
                    </div>
                </details>

                <!-- Part 2: ç›¤æ…‹èˆ‡æ”»æ“Š (ä¾æ“šåœ–ç‰‡æ›´æ–° - NEW) -->
                
                <details class="group border border-orange-200 rounded overflow-hidden" open>
                    <summary class="flex justify-between items-center font-bold text-orange-800 bg-orange-50 p-3">
